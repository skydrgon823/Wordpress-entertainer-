== Changelog ==
= 2.5.7 - 2021-03-10 =
* ENHANCEMENT: Added a pmpro_checkout_message filter that can be used to filter error messages shown at checkout.
* BUG FIX/ENHANCEMENT: Now making sure some billing address fields are available for the billing failure emails sent during the PayPal IPN handler.
* BUG FIX/ENHANCEMENT: Fixed issues where HTML entities were shown in level prices in some places when using certain currencies. All prices are sent through a special pmpro_escape_price function that allows div, span, and sup tags with id and class attributes. Also removed from unneeded small tags and grey coloring of prices in certain spots.
* BUG FIX: Now cancelling membership when a SUBSCRIPTION_CANCELED message is sent to the Braintree webhook handler. In the past, we incorrectly sent the payment failed email instead.
* BUG FIX: Fixed display issues with the Require Membership block. The level select field has been swapped with a list of checkboxes.
* BUG FIX: Fixed warnings that occurred when processing failed payments in webhook and IPN handlers.
* BUG FIX: Fixed our Braintree class so we will only attempt to update a user's credit card and address when the getCustomer method is called at checkout or during a billing update.
* BUG FIX: Fixed issue where refreshing the checkout review page when using PayPal Express caused the associated order to be updated again. Now the order status is updated to review and only updates again when the user confirms.
* BUG FIX: Avoiding warnings when the pmpro_url function is used if the PMPro pages haven't been set up yet. (Thanks, Thomas Sjolshagen)
* REFACTOR: Updated the pmpro_getSpecificMembershipLevelForUser( $user_id, $level_id ) function so both fields are required. Will still default to the current user if null is passed for the $user_id.

= 2.5.6 - 2021-03-05 =
* SECURITY: Now sanitizing and escaping the `order` parameter when filtering the users table in the dashboard. (Thanks, Gen Sato)
* BUG FIX/ENHANCEMENT: Now hiding the ApplePay/GooglePay "Payment Request" buttons when the main checkout form is submitted. This helps to prevent double checkouts.
* BUG FIX: Fixed missing membership data in the billing failed email.

= 2.5.5 - 2021-02-22 =
* SECURITY: Better sanitization of parameters on some REST API endpoints.
* SECURITY: Now showing reCAPTCHA field at checkout even for logged in users.
* ENHANCEMENT: Added find_billing_address() method to the MemberOrder class. This will look for the address on the last order with the same sub id or in user meta.
* ENHANCEMENT: Better styling for invoices shown on the frontend.
* ENHANCEMENT: No longer forcing column width % in the members list table.
* ENHANCEMENT: Added a pmpro_doing_webhook action that is fired at the beginning of our webhook/IPN handlers.
* ENHANCEMENT: Added a pmpro_membership_level_after_billing_details_settings hook to the edit membership level page. This hook should now be used to add billing related settings.
* BUG FIX/ENHANCEMENT: Allowing order total to be set to 0, even if there is a subtotal and tax amount.
* BUG FIX/ENHANCEMENT: Stripe checkout fields will now use the language set in the Stripe settings.
* BUG FIX/ENHANCEMENT: The URL check in our notifications code now accepts arrays (e.g. to see if a URL has one of a group of top level domains). This fixes a warning some may have seen in error logs.
* BUG FIX: Fixed issues where totals on PayPal recurring payments were sometimes incorrect if both an mt_gross and amount field were passed via IPN.

= 2.5.4 - 2021-01-28 =
* ENHANCEMENT: Bump license year 2021 - 10 years.
* ENHANCEMENT: Now passing billing street in `pmpro_tax` filter.
* ENHANCEMENT: Prefixed our pmpro_stripeResponseHandler function to avoid conflicts.
* ENHANCEMENT: Added getRealPaymentTransactionId method to PayPal Express gateway class to recover a missing transaction ID.
* ENHANCEMENT: Added `pmpro_checkout_before_form` action to hook anything before the membership checkout form.
* ENHANCEMENT: Added avatar as a valid field type for the [pmpro_member] shortcode.
* ENHANCEMENT: Changed license key field to text type and unmasked. Masking implied the key was hashed before saving which is not true.
* ENHANCEMENT: Added`pmpro_discount_code_used` action hook for when a discount code is used.
* ENHANCEMENT: Stripe will now pull billing address info for recurring orders from webhooks.
* BUG FIX/ENHANCEMENT: Improved user interface, error handling, and messages in the frontend password reset process.
* BUG FIX/ENHANCEMENT: Added a space between state and zip code in billing info.
* BUG FIX/ENHANCEMENT: Now rounding amount sent with Stripe payment request button.
* BUG FIX/ENHANCEMENT: Improved `pmpro_check_plugin_version` function to also check a specific value of the `get_plugin_data` array.
* BUG FIX/ENHANCEMENT: Added `pmpro_membership_levelmeta` and `pmpro_membership_ordermeta` tables to uninstall process.
* BUG FIX/ENHANCEMENT: Escaped things in SQL queries in 2Checkout INS service handler.
* BUG FIX/ENHANCEMENT: Cleaned up levels page template and added MMPU compatibility.
* BUG FIX/ENHANCEMENT: Fixed pagination and export issues with a discount code filter on the Orders admin page.
* BUG FIX/ENHANCEMENT: Prefixed our `pmpro_stripeResponseHandler` function to avoid conflicts with other Stripe code that may not be prefixed.
* BUG FIX/ENHANCEMENT: Cleaned up conditionals and escaping improvements in the `pmpro_redirect_to_logged_in` function.
* BUG FIX/ENHANCEMENT: Fixed deprecation notices for sites running PHP 8.
* BUG FIX/ENHANCEMENT: Improved SQL query format in the applydiscountcode service.
* BUG FIX: Fixed issues with ReCAPTCHA v2 and certain gateways.
* BUG FIX: Fixed bug where blog name was not showing in Admin Activity email.
* BUG FIX: Improved incorrect PHP doc blocks.
* BUG FIX: Fixed an issue on some sites where password reset link in email was incorrect.
* BUG FIX: Fixed level change issues during 2Checkout checkout.
* BUG FIX: Fixed issue where `checkout_levels` REST API endpoint could return the wrong initial payment
* BUG FIX: Fixed undefined notice for timestamp variable in the Stripe gateway class.
* BUG FIX: Avoiding warnings when user ids are in the memberships_users table, but a user doesn't exist.
* BUG FIX: Now setting the correct value for membership_id in the admin change emails.

= 2.5.3 - 2021-01-26 =
* SECURITY: Fixed indirect object reference vulnerability where order information, including customer names, email addresses, and order numbers could be accessed by non-admin WordPress users. (Thanks, WP Plugins Team)
* SECURITY: Now checking ReCAPTCHA validation before enabling the submit button on the checkout form when using ReCAPTCHA v2. This helps to keep bad actors from testing credit cards on your checkout page. We were already doing a similar check when using ReCAPTCHA v3. Further updates to rate limit credit card failures are planned.

= 2.5.2 - 2020-10-23 =
* BUG FIX: Fixed issue where the RECAPTCHA library wasn't being loaded early enough to validate at checkout.
* BUG FIX: Fixed issue where code in the Stripe class was unsetting some required fields, even if Stripe was not being used at checkout.

= 2.5.1 - 2020-10-16 =
* SECURITY: Fixed XSS vulnerability on the Members List page of the dashboard. (Thanks, Ron Masas from Checkmarx.com)
* ENHANCEMENT: Add Ukrainian Hryvnia currency. (Thanks, Mirco Babini)
* ENHANCEMENT: Added a "non-members" option to the Beaver Build module.
* BUG FIX: Fixed issue where only USD and US were allowed with Stripe's GooglePay/ApplePay buttons.
* BUG FIX: Fixed issue where some profile fields, e.g. those added with Register Helper, were accidentally updated or removed when accessing the frontend profile page.
* BUG FIX: Fixed issue with tracking discount code uses when using the 2Checkout gateway. (Thanks, karambk on GitHub)
* BUG FIX: No longer running excerpts through wpautop when a more tag is used.

= 2.5 - 2020-10-02 =
* FEATURE: When using the Stripe Gateway, you may now allow users to pay using Apple Pay, Google Pay, or Microsoft Pay depending on their browser. Enable this feature from the payment settings page.
* FEATURE: Added Divi Builder compatibility.
* FEATURE: Updated the Braintree Gateway class to be able to use the Braintree API for the pmpro_next_payment() function. Note, for performance reasons, you must call this method directly or enable it by hooking it up with code like `add_filter('pmpro_next_payment', array('PMProGateway_braintree', 'pmpro_next_payment'), 10, 3);`
* FEATURE: Added ordermeta tables and functions. We will wait about a year for all users to upgrade before using these widespread. (Thanks, Mirco Babini)
* ENHANCEMENT: The "short" version of the level cost text for a free level is now "Free" instead of "0.00 now".
* ENHANCEMENT: Added a `get_original_subscription_order` method to the MemberOrder class. This will return the first order in a subscription when called from a recurring order.
* ENHANCEMENT: Removed the old style license nags.
* BUG FIX/ENHANCEMENT: Using microtime and a static counter int to make sure our order and discount codes are unique. In the past very high traffic sites could run into duplicates if two checkouts happened at the exact same second.
* BUG FIX/ENHANCEMENT: Adjust order delete prompt to support other locales.
* BUG FIX/ENHANCEMENT: Better handling of tax amounts in recurring payments, e.g. when using the PMPro VAT Tax add on.
* BUG FIX/ENHANCEMENT: Optimized how often we hit the Stripe API when events on the checkout page could potentially update the price of checkout.
* BUG FIX/ENHANCEMENT: The checkout_levels api call now takes `level` as param.
* BUG FIX/ENHANCEMENT: No longer running sanitize_text_field on password fields. This would break passwords that had strings of characters resembling html tags.
* BUG FIX/ENHANCEMENT: Now warning admins if the Stripe billing period is longer than 1 year. Billing periods greater than 1 year are not allowed by Stripe.
* BUG FIX/ENHANCEMENT: Now detecting when a Stripe webhook is set up for an older version of the Stripe API and showing a notice with a link to update.
* BUG FIX/ENHANCEMENT: Adding MAXFAILEDPAYMENTS=1 to PayPal add subscription requests. This tells PayPal to cancel a subscription after the first failed payment. In our experience, the automatic retries rarely worked well. This change fixes issues with subscriptions going out of sync or users retaining access to your site when their payment has failed. Members still receive the payment failed email, which prompts users to return to the site to renew.
* BUG FIX/ENHANCEMENT: Fixing some issues where we are adding extra break tags into the password reset email. There are still some issues like this when using certain plugins. We are working on a general fix.
* BUG FIX/ENHANCEMENT: Removed the "coupon amount" field from the edit order page. These were hold outs from the 2007! ecommerce plugin PMPro was forked from. You can set the pmpro_orders_show_coupon_amounts filter to __return_true to show these fields again if you were using them for tracking things in your custom code.
* BUG FIX: Fixed MMPU compatibility when using discount codes.
* BUG FIX: No longer filtering the wp login url when on wp-login.php. This fixes issues with iThemes Security 2FA.
* BUG FIX: Fixed issues where the Stripe webhook was not being updated sometimes when clicking the button to update.
* BUG FIX: Fixed some notices and warnings when using Braintree.
* BUG FIX: Now resetting memberslist page number when changing shown level.
* BUG FIX: Now ensuring that the discount code field updates, update the Request Button price.
* BUG FIX: Fixed issue where non-pretty permalinks may break frontend password resets.
* BUG FIX: Fixed invoice links on the account page. (Thanks, Mateusz Hołtyn)
* BUG FIX: Fixed incorrect label "for" attribute for uninstall setting.
* BUG FIX: Fixed issue where some free plugins distributed by PMPro would show warnings about requiring a Plus license.

= 2.4.4 - 2020-09-02 =
* BUG FIX: Fixed fatal error that sometimes occurred on the payment settings page when using PHP 5.6 or earlier.
* BUG FIX: Fixed fatal errors that showed up on the frontend invoice page.
* BUG FIX: Fixed issue where the confirmation message was not showing up in the confirmation email if that option was checked.
* ENHANCEMENT: Added a pmpro_stripe_charge_params filter that can be used to edit or add params sent to the Stripe create charge method. (Thanks, Michael Bester)
* ENHANCEMENT: Tweaked the markup of the invoice page so the payment type information looks a little better.

= 2.4.3 - 2020-08-25
* SECURITY: Fixed a cross-site scripting vulnerability in the code that updates the Required Membership settings on a post. This vulnerability could have been used in conjunction with other security vulnerabilities to trick an admin into editing the membership settings for a page, potentially exposing members only content to non-members. It is unlikely that there was any active exploitation of this vulnerability. This issue may also have shown up as a bug on some sites using page builders, where the membership settings for a post would be cleared out when editing a post. (Thanks to the wp.org plugin review team for catching this issue.)
* SECURITY: Better escaping of variables shown in the Require Membership meta box and related SQL queries.
* BUG FIX/ENHANCEMENT: Renamed the Vietnamese language files to match what is expected.

= 2.4.2 - 2020-08-24
* SECURITY: Updated the PMPro REST API endpoints accessed via the GET method to also require appropriate capabilities to access. The membership confirmation text will be hidden from non-members and non-admins. The endpoints to check a user's level or access to a post require the pmpro_edit_memberships capability now. You should make sure your API users have the appropriate capabilities to use the API. You can use the pmpro_rest_api_route_capabilities filter and/or pmpro_rest_api_permissions filter to change this behavior.
* BUG FIX: Fixed issues with the PMPro REST API endpoints, including the discount code and checkout level endpoints.
* BUG FIX: Fixed issue with backslashes in the display name when editing form the PMPro frontend profile page.
* BUG FIX: Fixed issue where timestamps were showing up incorrectly for recent orders shown on the dashboard page.
BUG FIX: Fixed issue where PMPro would always try to add capabilities to the administrator role, even if you removed that role for some reason.
* ENHANCEMENT: Added a pmpro_get_no_access_message() function, which can be used to show the no access messages.
* ENHANCEMENT: Added a "show_noaccess" property to the membership shortcode. When set, it will show the noaccess message to users who don't have the levels specified.
* ENHANCEMENT: Added a pmpro_user_profile_update_errors hook, which can be used to show errors on the PMPro frontend profile page.
* ENHANCEMENT: The pmpro_set_capabilities_for_role() function now returns true or false if the caps were added in case others want to use this function and tell if it worked.
* ENHANCEMENT: You can now include links in the description of the fields you add to the PMPro advanced settings page via the pmpro_custom_advanced_settings filter.
* ENHANCEMENT: Updated the PayPal gateways to use the latest versions of the PayPal buttons.
* ENHANCEMENT: Fixed styling of the PMPro update script notice.
* ENHANCEMENT: Added the pmpro_account_membership_expiration_text filter to the expiration dates shown on the cancel page when using MMPU.

= 2.4.1 - 2020-08-10 =
* BUG FIX: Fixed issues with password resets on WP Engine hosting due to security features added by their mu-plugin.
* BUG FIX: Fixed issue where end dates were showing up incorrectly in the confirmation email sometimes.
* BUG FIX: Fixed issue where renewing memberships were extended one day less than they should have been in some cases.
* BUG FIX: Fixed issue where users without a PMPro Plus license were sometimes not getting an error when trying to update a Plus Add On.
* BUG FIX/ENHANCEMENT: Added compatibility for core auto-updates for our Add Ons which aren't hosted in the .org repository.
* BUG FIX/ENHANCEMENT: Fixed issue where PHP sessions were set up to track ReCAPTCHA even if you weren't using ReCAPTCHA. ReCAPTCHA is now only loaded on the checkout page. Loading sessions unecessarily would break some Varnish cache setups.
* BUG FIX/ENHANCEMENT: Updated the single invoice/order page. No longer showing the end date, which isn't really related to the order. Showing a better status related to the order now.
* BUG FIX/ENHANCEMENT: Fixed some links to the PMPro site in the plugin admin area.
* BUG FIX/ENHANCEMENT: Now saving a hash of the Stripe secretkey when saving webhook ids. This allows us to keep track of webhook ids if you switch between gateway environments or swap your Stripe keys for some reason.
* BUG FIX/ENHANCEMENT: No longer running the Terms of Service text through wpautop. This usually just added extra spacing to your TOS. Shortcodes are rendered now though. Added a filter pmpro_tos_content so you can change the TOS content or how it is shown.
* ENHANCEMENT: Added a checkout_levels API endpoint. This will allow us to build features that adjust the price on the frontend at checkout.
* ENHANCEMENT: Added a pmpro_member_profile_edit_form_tag action to the form tag on the frontend member profile page. This is useful to set the form enctype for file uploads.
* ENHANCEMENT: Added Romanian Leu as a currency option.
* ENHANCEMENT: Added the pmpro_stripe_payment_intent_params filter. Useful if you would like to set a specific statement descriptor for the site. See https://gist.github.com/ideadude/16983fdfa0da12fc40ef36d870f4cbd0
* REFACTOR: Removed some unused methods from the Stripe class.
* REFACTOR: Removed the help pointer about the menu location change.

= 2.4 - 2020-07-24 =
* FEATURE: Now detecting if the Stripe webhook is set up correctly. You can now create or disable the webhook from the payment settings page in the WP admin dashboard.
* FEATURE: Added a link to use and set up SendWP for more reliable email sending from WP.
* BUG FIX: Fixed further issues with dates and timezones.
* BUG FIX: Fixed issue where reports would cause white screens on some server set ups. We had some report start dates set to 1960, which caused issues. (Thanks, Sam "gausam" on GitHub)
* BUG FIX: Fixed issue with the query to find expiring memberships that happened on certain MySQL setups.
* BUG FIX: Fixed issue that was caused if other code called wp_login_url() too early.
* BUG FIX: Fixed an error in the is_login_page() function.
* BUG FIX: Fixed a fatal error that was happening in PHP 5.2 or earlier due to code syntax that was not supported then. We noticed a few other cases as well, but decided we won't support PHP 5.2 consistent with WP and other plugins.
* BUG FIX: Fixed the URL used when using 2Checkout in sandbox mode.
* BUG FIX: Fixed JavaScript errors that would occur sometimes on the Billing Update page when using the Stripe gateway.
* BUG FIX: Fixed issue where the dummy $0 orders created when using the "Stripe Updates" feature weren't saving with the updated subscription_transaction_id. This would prevent future payments from being linked to that user and could prevent subscriptions cancellations from being synchronized. When updating to PMPro 2.4, an update script will run to try to restore these subscription_transaction_id values. However, any recurring orders that occured when the id was missing will not be added to PMPro. You will have to update them manually.
* BUG FIX: Fixed JavaScript error on the edit discount code page.
* BUG FIX/ENHANCEMENT: Showing expiration date as text when it is set as a readonly field. (Thanks, Rodmar "rodmarzavala" on GitHub)
* BUG FIX/ENHANCEMENT: Now checking if headers were already sent before trying to start the PHP session. If headers are sent before PMPro tries to start the session, there is usually another error somewhere on the WP site that needs to be fixed. But at least we aren't adding to the confusion by trying to start the session late causing another error in the log.
* BUG FIX/ENHANCEMENT: Updated misleading hint for the PayPal Express IPN URL on the payment settings page.
* BUG FIX/ENHANCEMENT: Fixed invalid key description in the SQL in includes/setup.sql. The actually query used to set up table in PMPro was correct though. The setup.sql file is included for reference and developers who want to create the tables "manually" in MySQL.
* BUG FIX/ENHANCEMENT: The post type search filter now supports cases where post type set in WPQuery is an array.
* BUG FIX/ENHANCEMENT: Fixed warning that showed when a user with no levels visited the frontend account page.
* BUG FIX/ENHANCEMENT: Fixing warnings that would be logged at checkout in certain cases.
* BUG FIX/ENHANCEMENT: Better handling of cases where users who checked out using a gateway different from the current setting are shown a message that they cannot update their billing information. They should instead checkout again to renew their membership.
* ENHANCEMENT: Updated to use the latest version of the Stripe API and SDK.
* ENHANCEMENT: More detailed logging for Braintree webhook debug emails.
* ENHANCEMENT: Added a getTransactionStatus method to the PayPal and PayPal Express payment gateway classes. (Thanks, Mirco Babini)
* ENHANCEMENT: Added a checkout_level API call. This will be used in the future to update the price total at checking using JS and is also needed to implement support for Google Pay and Apple Pay through Stripe.
* ENHANCEMENT: Cleaned up the email settings page.
* ENHANCEMENT: Better handling of some login and password reset errors.
* ENHANCEMENT: Added links to the PMPro YouTube and Facebook profiles.
* REFACTOR: Cleaned up some code in incldues/content.php, especially around the pmpro_search_filter() function.
* REFACTOR: Removed the package-lock.json file from the repository.

= 2.3.4 - 2020-06-18 =
* SECURITY: Better escaping of values on the billing and confirmation pages.
* BUG FIX: Fixed issue where expiration dates could be set to 1 day in the past when editing a user in the dashboard if certain timezones were chosen in the General settings.
* BUG FIX: Fixed issue where users were redirected back to the /login/ page if WordPress needed them to confirm their admin email address. Users will now be taken to the default WP login page with the form to confirm their email address.
* BUG FIX: Fixed bug where the reset password link in the new user email was not filtered to go to the frontend login page if being used.
* BUG FIX: Fixed issue where some errors were not being shown when password resets failed.
* BUG FIX: Fixed bug with action links added to the orders table.
* BUG FIX: Fixed issue where empty dates would show current date in the members list.
* BUG FIX: Fixed fatal error that was happening when using some of the new API endpoints.
* BUG FIX: Timestamps returned by the Stripe API when getting the next payment date needed to be adjusted based on the site's timezone setting.
* BUG FIX: Fixed a bug where the change password form wouldn't show up sometimes when using the login shortcode.
* BUG FIX: Fixed notice in the PayPal IPN handler when adding notes to an order.
* BUG FIX: Fixed issue where PMPro would generate the wrong excerpt in some cases where the more tag was used but the excerpt was generated before the more tag code or blog was not yet converted to HTML. Specifically this fixes an issue with excerpts generated for AMP with the SchemaApp plugin.
* BUG FIX/ENHANCEMENT: Added an advanced setting to "Uninstall PMPro on Deletion". You must check and save this option first or PMPro will not delete data from the DB when deleting from the plugins page. This keeps users from accidentally deleting orders and member data.
* BUG FIX/ENHANCEMENT: Now hiding the profile and change password links on the membership account page if a frontend profile page is not set and users are locked from the WP dashboard by the advanced setting.
* BUG FIX/ENHANCEMENT: Resetting the signups and cancellations report cache when there are new membership level changes.
* ENHANCEMENT: Added a pmpro_get_element_class function and filter. We now use this function when adding classes to HTML elements in our templates. The filter can be used to alter or append to the classes used in the HTML tags. This will make it easier to create code and CSS to make PMPro look better with popular themes.
* ENHANCEMENT: Added a pmpro_authorizenet_post_values filter to the Authorize.net class. An array of $post_values is passed in to be filtered along with a string for the API method about to be called.
* ENHANCEMENT: Added a pmpro_member_profile_edit_user_object_fields filter to add or remove fields from the frontend edit profile page.
* ENHANCEMENT: Now showing information about the current billing method on the update billing page. Can hide this information by having the pmpro_billing_show_payment_method filter return false.
* ENHANCEMENT: No longer saying "Great Work!" in the admin digest emails. This was especially embarrassing if you didn't have any sales during the diget period.
* REFACTOR: Refactored some code in the CSV exports to avoid false positives by malware scanners.
* REFACTOR: Added a build_post_string method to the Authorize.net class to avoid redundant code.
* REFACTOR: Added a cancelSubscriptionAtGateway method to the PayPal Express class. This is useful if you want to cancel the subscription without cancelling the membership. (Thanks, Mirco Babini)

= 2.3.3 - 2020-05-13 =
* SECURITY: Fixed SQL injection vulnerability when logged in as an administrator and adding new orders in the dashboard. JVN#20248858 (Thanks, Kenichi Okuno of Mitsui Bussan Secure Directions, Inc)
* SECURITY: Making sure to properly escape all values on the add/edit order form in the dashboard.
* BUG FIX: Now properly setting the order status to "error" when an initial payment fails when using PayPal Express. Before the order status would be set as "cancelled", which would count the order toward reports and make it harder to find orders that had errors. (Thanks, Mirco Babini)
* BUG FIX: Fixed issue with the PMPro logo and some other assets loading over the wrong schema (http vs https) in some cases.
* BUG FIX: Fixed issue where the chosen discount code was not shown after submitting when adding a new order through the dashboard.
* BUG FIX/ENHANCEMENT: Using "PMPro" in the admin activity email subject to keep the line shorter and avoid issues when replacing the word "member" via gettext.
* ENHANCEMENT: Added a pmpro_allow_weak_passwords filter. You can set this to return true (like this https://gist.github.com/ideadude/5a12119b9ce1c2aad87b2d69cb8f9505) to allow weak passwords on the change password and reset password pages. Note that at this time, weak passwords are still allowed on the checkout page no matter the value of this filter. We expect to change that in the future. For now, you can use our PMPro Strong Passwords plugin to force strong passwords at checkout.
* REFACTOR: Updated the logic around checking the PMPRO_IPN_DEBUG constant in the IPN handler. (Thanks, Mirco Babini)

= 2.3.2 - 2020-05-07 =
* BUG FIX: Fixed errors calling is_main_query() that came up with certain themes.
* BUG FIX: Fixed typo in the pmpro_account_profile_action_links filter.
* BUG FIX/ENHANCEMENT: Added a new force parameter to the pmpro_getAllLevels() function. This is used by the Multisite Membership Add On to fix an issue where levels were missing or incorrect on the subsites.
* ENHANCEMENT: Removed mention of the ezAdsense plugin, which has been discontinued.
* ENHANCEMENT: Added $recipient param in sendAdminActivity() function so you can send additional activity emails like this https://gist.github.com/dparker1005/6bf650370a12aef44adf8c8c26d3e906

= 2.3.1 - 2020-05-01 =
* BUG FIX: Fixed infinite redirect issue if no account page was set. Fixed a few other places where we do is_page() type checks just in case.
* BUG FIX: Fixed issue where all pages were retitled to Welcome when logged in, if no login page was set.
* BUG FIX: Fixed issue with BuddyBoss and other themes/plugins that use the_title filter with only one parameter.
* BUG FIX: Fixed error when trying to check if is_main_query in the admin or with certain themes.

= 2.3 - 2020-05-01 =
* FEATURE: Added frontend login and password reset.
* FEATURE: Added frontend user profile editing.
* FEATURE: Added [pmpro_login] shortcode and Log In Form block.
* FEATURE: Added [pmpro_member_profile_edit] shortcode and Member Profile Edit block.
* FEATURE: Added "Member Log In" widget.
* FEATURE: Added "WordPress Toolbar" Advanced Setting to hide the WordPress Toolbar from "subscriber" role.
* FEATURE: Added "WordPress Dashboard" Advanced Setting to block dashboard access for the "subscriber" role.
* FEATURE: Added new Admin Activity Email. Weekly emails to the site admin with sales stats and other info. Change how often the email is sent or disable it from the advanced settings tab.
* FEATURE: Added Beaver Builder module compatibility to restrict modules by membership level.
* FEATURE: Created new REST API endpoints and extended existing endpoints.
* FEATURE: Updated Elementor code to allow for restriction of "sections" as well.
* BUG FIX: Updated all timestamp code to be compatible with WordPress v5.4+ which fixes issues where orders could lose one hour or one day when saved.
* BUG FIX: Updated logic to filter body_class on pages with Membership Account shortcode or any "section" of the shortcode displayed.
* BUG FIX: Improved `pmpro_getAllLevels` function to cache even when `force` is `true`. This saves multiple DB hits per page load.
* BUG FIX/ENHANCEMENT: Cancellation report now calculates based on membership enddate.
* BUG FIX/ENHANCEMENT: Fixed warnings and errors in PHP 7.4+.
* BUG FIX/ENHANCEMENT: Now allowing translation for text generated by JavaScript.
* BUG FIX/ENHANCEMENT: Updated all uses of "Email" to remove the hyphen.
* BUG FIX/ENHANCEMENT: Updated to default to international addresses on Billing Information page. Fixes a bug with the State Dropdown Add-On.
* BUG FIX/ENHANCEMENT: Now treating "recurring_payment_failed" transactions from PayPal IPN as cancellations. PMPro will cancel membership and attempt to cancel the associated subscription.
* ENHANCEMENT: Added membership level class for the `PMPro_Membership_Level` object. This is currently only used in the REST API calls, but will eventually be used whenever interacting with a membership level object or array.
* ENHANCEMENT: Added discount code class for the `PMPro_Discount_Code` object. This is currently only used in the REST API calls, but will eventually be used whnever interacting with a discount code object or array.
* ENHANCEMENT: Now allowing all users and members access to the Membership Account page.
* ENHANCEMENT: Updating logic for all redirects from core pages like Invoices, Billing, and Cancel to allow past members to access their data. Generally more often redirecting where you would expect to in different situations.
* ENHANCEMENT: Several core frontend page style improvements for responsive displays and gateway-dependent fields.
* ENHANCEMENT: Added `getSubscriptionStatus` method to the Stripe gateway API class. This fixes issues with the PMPro Subscription Check Add-On.
* ENHANCEMENT: Added !!levels_page_url!! and !!login_url!! as replacement variables in Advanced Settings > Message Settings. Using these by default on new installs.
* ENHANCEMENT: Improved Block Editor code and webpack configuration.
* ENHANCEMENT: Added support for `PMPRO_AUTHNET_SILENT_POST_DEBUG` to "log" data to /logs/ or send an email to an email address different from the site admin.
* ENHANCEMENT: Added time fields to Memberships > Orders admin page when vieweing, updating or saving an order.
* ENHANCEMENT: Added pmpro_admin_orders_filters and pmpro_admin_orders_query_condition filters to add new filters to the orders page in the dashboard. (Thanks, Mirco Babini)
* ENHANCEMENT: Added an SVG icon to the PMPro blocks category.
* REFACTOR: Improved the Members List list table code to use a function for each column of data and support the code core WP methods for extending list tables with custom columns.
* REFACTOR: Moved all Theme My Login compatiblity code to includes/compatibility/theme-my-login.php and only loading if plugin is active.

= 2.2.6 - 2020-02-20 =
* SECURITY: Escaping the post title shown in the Terms of Service section of the checkout page.
* BUG FIX: Fixed issue where the CVV/Security Code was not being passed to Authorize.net when using that gateway.
* BUG FIX: Fixed issues with the update billing page when using Stripe.
* BUG FIX: Fixed issues with the update billing page when using the MMPU Add On.
* BUG FIX: Fixed issue where password fields would disappear when the checkout form was submitted. This behavior was required to address bugs in older versions of iOS that shouldn't be in use any more.
* BUG FIX: No longer sending an extra cancel request to the PayPal API when processing a cancel for a PayPal Express subscription through the IPN handler.
* BUG FIX: The currency option is no longer hidden when using the check gateway.
* BUG FIX: Fixed the comparisons in the pmpro_check_plugin_version function and related notification checks.
* BUG FIX: Avoiding warnings in the sendAdminChangeEmail method if the user doesn't have a level.
* BUG FIX: Fixed some cases where the Members List CSV export wouldn't match the members shown in the table/search.
* BUG FIX: Fixed issue where the Members List may show the wrong count or enddate.
* BUG FIX/ENHANCEMENT: Added support for Elementor. Filtering content later so the builder's filters can run first. Also added the ability to choose which membership levels an element should be visible for.
* BUG FIX/ENHANCEMENT: Fixed the confirmation page formatting when paying by check. Added a div with class "pmpro_payment_instructions" around the payment instructions shown on the confirmation and invoice pages.
* BUG FIX/ENHANCEMENT: Added an Oxford Comma to the the pmpro_implodeToEnglish() function.
* BUG FIX/ENHANCEMENT: Moved the Japanese Yen symbol to the left of the total instead of the right.
* BUG FIX/ENHANCEMENT: Added the pmpro_checkout_login_redirect filter, which filters the url_redirect parameter of the login link on the checkout page. This is used by some Add Ons to make sure you are returned to the checkout page properly after logging in through that link.
* ENHANCEMENT: Added the Ghanian Cedi currency.
* ENHANCEMENT: Added the pmpro_are_levels_recurring() function to help with MMPU.
* ENHANCEMENT: Improved the look and source of the CVV popup.

= 2.2.5 - 2020-01-05 =
* BUG FIX: Once again loading JavaScript on the update billing page when using Braintree.
* BUG FIX: Loading Braintree JavaScript at checkout for free levels to support the variable pricing and donation add ons.
* BUG FIX: Fixed issues with PayPal orders when using the pmpro_paypal_level_description filter.
* BUG FIX/ENHANCEMENT: Responsive update for smaller device viewports for the Membership Levels table in the dashboard.
* ENHANCEMENT: Added filters: pmpro_is_level_free, pmpro_is_level_trial, and pmpro_is_level_expiring.

= 2.2.4 - 2019-12-20 =
* BUG FIX: Fixed issue with the update billing page when using the Stripe gateway.

= 2.2.3 - 2019-12-09 =
* BUG FIX: Fixed issue where Stripe checkout failed for free levels that had their price adjusted through the donations or variable pricing add ons.
* BUG FIX: Fixed undeclared variables warnings in the members list.
* BUG FIX: Fixed the edit user links in the email sent to admins when cancelations have errors.
* REFACTOR: Removed some unused code from the members list class.

= 2.2.2 - 2019-11-29 =
* BUG FIX: Fixed issue with member search.
* BUG FIX: Fixed issue with custom columns in the members list. (Thanks, Tim Sparks)

= 2.2.1 - 2019-11-27 =
* BUG FIX: Fixed performance issues with the new WP List Table implementation of the members list.
* BUG FIX: Fixed sorting issues with the new members list.
* BUG FIX: Fixed issues with the sales report widget and breakdown by price.
* BUG FIX: Now showing an appropriate message if you search for members, levels or discount codes in the dashboard and there are no results.
* BUG FIX: Fixed bug where option to pay with PayPal wouldn't show if paid discount code was applied to free level.

= 2.2 - 2019-11-22 =
* FEATURE: The Members List is now shown in an official "WP List Table". Most columns are sortable. The screen options in the upper right can be used to add/remove columns. (Thanks, Thomas Sjolshagen, Paul Barthmaier, and David Parker)
* FEATURE: Showing useful notifications in the PMPro dashboard area. Notifications are shown no more than once ever 12 hours, and no more than 3 times every week. The PMPro Advanced Settings page has an option to only show security-related notifications.
* SECURITY: Better sanitizing of values in the 2Checkout INS handler.
* BUG FIX: Fixed issue since WP 5.3 where expiration dates and other dates could be off by a month after saving.
* BUG FIX: Fixed issue where Stripe orders processed through the webhook would use the current date instead of the date of the order. This was an issue if you had to rerun a webhook later.
* BUG FIX: Fixed issue level confirmation text was sometimes not shown in emails when it was supposed to.
* BUG FIX: Russian Rubles are now configured to have 2 decimals again. In practice, decimals aren't often used for rubles and we are looking into ways to store the decimals (because gateways like Stripe need them) while showing values without decimals.
* BUG FIX: Fixed bug where the "logged in as" message would sometimes show twice on the update billing page.
* BUG FIX/ENHANCEMENT: Updated dashboard to adopt WordPress 5.3 formatting updates.
* BUG FIX/ENHANCEMENT: Updated frontend pages to improve cross-browser and cross-theme compatibility.
* BUG FIX/ENHANCEMENT: New free orders will always have the "success" status after checkout.
* BUG FIX/ENHANCEMENT: Better handling of tax values in the PayPal IPN handler.
* ENHANCEMENT: Added "Edit User" and "Edit Order" links to the admin email when a gateway subscription fails to cancel.

= 2.1.4 - 2019-10-31
* BUG FIX: Better exception handling in the Stripe gateway class for PHP 7+.
* BUG FIX: Fixing some JS issues at checkout, e.g. related to the "validateCreditCard method is not available" error.
* BUG FIX: Better messaging if the Stripe Billing Limits Add On is already installed.
* BUG FIX: Fixed cases where PMPro would email users about credit cards expiring when they had used an offsite gateway like PayPal Express.
* BUG FIX: Fixed issue where some user information was missing from the pmpro_orders_user_row_actions filter.
* BUG FIX: Fixed issues where the level confirmation text was not available in some cases.
* BUG FIX/ENHANCEMENT: Updates to the French language translation.

= 2.1.3 - 2019-10-14 =
* BUG FIX: Updating Stripe subscriptions from the edit user page will no longer cause an extra charge.
* BUG FIX: Correctly localizing the expiration date on the frontend account page.
* BUG FIX: Moved the row actions on the orders page into the correct column. (Thanks, Tim Sparks)
* BUG FIX: Fixed issue with CSV exports if the fpassthru function is unavailable.
* BUG FIX: Fixed warning that occurred when the Email Log plugin was active. (Thanks, Matty Cohen)
* BUG FIX: Fixed warning that occurred with sessions sometimes. (Thanks, Matty Cohen)
* ENHANCEMENT: Made labels and styling more consistant across settings pages.
* ENHANCEMENT: The Consent Log will go into a scrollable box if more than 10 items are in the list.
* ENHANCEMENT: Updated the copy on the license page.

= 2.1.2 - 2019-09-26 =
* BUG FIX: Fixed bug where Stripe subscriptions weren't updated to use the new payment method when users updated their billing method on the Update Billing page. You may have users with an updated "default payment method" but their subscriptions still need to be updated manually in Stripe to use that new method. Otherwise, payments will fail. This is fixed going forward.
* BUG FIX: Fixed bug where PMPro Blocks were sometimes not loading on the edit post page.
* BUG FIX: Fixed bug where discount codes would cause ugly warnings to be shown on the checkout page.
* BUG FIX: Fixed bug where custom templates would sometimes not load.
* BUG FIX: Fixed issue where a warning was thrown sometimes when loading SESSION vars.
* ENHANCEMENT: Moved the License page under Memberships.
* ENHANCEMENT: Updated our UTM tracking links in various places we link to the Paid Memberships Pro website.
* ENHANCEMENT: Added some help text and links to popular add ons in a few places in the PMPro settings.

= 2.1.1 - 2019-09-16 =
* BUG FIX: Fixed issue with SCA authentications via Stripe for subscriptions with a $0 initial payment. (Thanks, mjulian87 on Github.)
* BUG FIX: Fixed issue where code was shown in the message box when applying a discount code.
* BUG FIX: Fixed issue where pmpro_is_checkout() would always return true if no checkout page was set. This caused JavaScript issues on non-checkout pages.
* BUG FIX: The SVN repo on WordPress.org was missing a file for about 10 minutes after version 2.1 was pushed. Users who upgraded during this time may be missing that file. Updating now will restore it.

= 2.1 - 2019-09-13 =
* FEATURE: Updated Stripe integration to support Stripe v3, Stripe Elements, and their Secure Customer Authorization process.
* FEATURE: Updated how we store prices to support up to 8 decimals (e.g. for Bitcoin gateway implementations).
* ENHANCEMENT: Improved error messaging on the update billing page when a gateway doesn't support it or the user's current membership doesn't have a subscription.
* ENHANCEMENT: Added a  pmpro_is_checkout() function that will return true if on the PMPro checkout page or a page with the PMPro checkout shortcode or block.
* ENHANCEMENT: Showing a warning message when a user about to be deleted has a membership so admins know that existing subscriptions will be deleted at the gateway.
* ENHANCEMENT: Added a pmpro_braintree_plan_id filter in case you need to adjust plan IDs. This is useful if you have several sites running on the same Braintree account.
* ENHANCEMENT: Added a pmpro_num_expiration_years filter to adjust the number of years to include in the dropdown to set the year membership will expire.
* ENHANCEMENT: Tweaked the UI of the orders list and members list in the dashboard.
* ENHANCEMENT: Added pmpro_membership_levels_table_extra_cols_header and pmpro_membership_levels_table_extra_cols_body hooks to add columns to the members list.
* ENHANCEMENT: Showing notices to admins when categories are hidden from them on the frontend of the site.
* ENHANCEMENT: Added a pmpro_url filter to filter URLs returned from that function.
* ENHANCEMENT: Adding a pmpro_checkout_gateway-stripe or pmpro_checkout_gateway-paypal/etc CSS class to the wrapping div for payment fields to aid in styling.
* ENHANCEMENT: Using the site's date format option when printing orders.
* BUG FIX/ENHANCEMENT: If a site has no paying levels, the test gateway will show as the "Default" gateway and we will no longer show a message about requiring gateway setup on the checkout page.
* BUG FIX/ENHANCEMENT: Updated Russian Ruble definition to have 0 decimals and use &nbsp; as the thousands separator. (Thanks, Airat Halitov)
* BUG FIX/ENHANCEMENT: Using add_query_arg when generating IPN URLs to avoid issues on sites that aren't using pretty permalinks or have moved their admin directory.
* BUG FIX/ENHANCEMENT: Fixed issue on advanced settings page where clicking on labels didn't check the corresponding check boxes.
* BUG FIX/ENHANCEMENT: Updated our pmpro_generateUsername() function to be a bit smarter.
* BUG FIX/ENHANCEMENT: Now using wp_generate_password() when choosing a random password for a user (e.g. when using the Sign Up Shortcode add on or the $skip_account_fields global).
* BUG FIX/ENHANCEMENT: Setting autocomplete to false on the "fullname" honeypot field. This will prevent user's with certain autocomplete tools from accidentally filling it out.
* BUG FIX/ENHANCEMENT: Now sending name and email fields to PayPay (using Website Payments Pro) even if no address was captured.
* BUG FIX/ENHANCEMENT: More specific CSS selectors for checkout form elements to make sure errors are highlighted/etc with different themes.
* BUG FIX: Fixed issue where the first 2000 or so orders might be skipped when exporting orders on large sites.
* BUG FIX: Fixed issue with setting custom trials on discount codes.
* BUG FIX: Fixed issue in the SQL query in the pmpro_calculateInitialPaymentRevenue() function. This function is deprecated, but still used by some custom code.
* BUG FIX: Fixed issue where default templates would fail to load if a custom template was specified.
* BUG FIX: Fixed fatal errors that could happen when using the PMPro REST API endpoints.
* BUG FIX: Fixed bug where the invoices page would sometimes show data for the current (admin) users instead of the user the invoice was for.
* BUG FIX: Fixed bug where the membership stats graphs would sometimes show up blank.
* BUG FIX: Now falling back to using readfile() if fpassthru() doesn't existing.
* BUG FIX: Fixed issue where the from name and email were not set properly if the Only Filter PMPro Emails setting was checked. (Thanks, mjulian87 on GitHub)
* BUG FIX: Fixed several error handling issues with the Cybersource gateway integration.
* REFACTOR: Moved JavaScript out of pages/checkout.php and other places into files in the /js/ folder. This will avoid issues where other JS at checkout breaks PMPro checkout and will improve compatibility with tools that optimize JS.
* REFACTOR: Added unit testing and a started on coverage of some functions in includes/functions.php. (Thanks, Mike Auteri)
* REFACTOR: The JS function askfirst is now prefixed as pmpro_askfirst.

= 2.0.7 - 2019-05-30 =
* BUG FIX: Fixed issue where the profile start date would sometimes be set incorrectly on the Stripe subscription.
* BUG FIX: Fixed issue where the membership shortcode would not work properly if more than one level name was given.
* BUG FIX: Fixed issue where an incorrect email address was sometimes set in the confirm email field on the update billing page. (Thanks, Jessica Thomas)
* BUG FIX/ENHANCEMENT: Fixed placement of the hr tag above the user fields at checkout for consistency.
* ENHANCEMENT: Set the priority on the Require Membership meta box to "high" so it appears higher in the right sidebar.

= 2.0.6 - 2019-05-30 =
* SECURITY: Now using wp_safe_redirect when possible, especially in includes/login.php where the user-provided redirect_to URL parameter is used. (Thanks PluginVulnerabilities.com)

= 2.0.5 - 2019-04-25 =
* BUG FIX: Fixed fatal error on return from 2Checkout.
* BUG FIX: Removed error when installing PMPro via WP-CLI.
* BUG FIX: Fix database upgrade error on localhost environment. (Thanks, codezz on GitHub)
* BUG FIX: Fixed issue where the credit card expiring email didn't include user info because the user ID wasn't passed in properly. (Thanks, David Cervantes Caballero)
* BUG FIX: Fixed typo on edit level page. (Thanks, Theuns Coetzee)
* BUG FIX: Fixed bug with daily revenue reports not showing up in some cases.
* BUG FIX: Now checking before cancelling a Stripe subscription at the gateway to see if it has already been cancelled.
* BUG FIX/ENHANCEMENT: Now caching the query results in pmpro_getMembershipLevelsForUser(). This improves performance, especially when there are many posts on one page to check membership for. (Thanks, Seagyn Davis)
* BUG FIX/ENHANCEMENT: Now sending display_name to the $data array passed to PMPro email filters. (Thanks, David Cervantes Caballero)
* BUG FIX/ENHANCEMENT: Now searching for the last order with "success" or "pending" status on the Billing page.
* BUG FIX/ENHANCEMENT: Added pmpro_checkout_preheader_before_get_level_at_checkout and pmpro_checkout_preheader_after_get_level_at_checkout action hooks. Using pmpro_checkout_preheader_before_get_level_at_checkout to start the session earlier now.
* BUG FIX/ENHANCEMENT: Removed the "membership_code_id" and "membership_code" as field options for the member shortcode. These weren't working and it's unclear what would be meant to ask for a user's discount code since a user could have several orders with or without discount codes. Added "membership_description" and "membership_confirmation" instead.
* BUG FIX/ENHANCEMENT: Filtering the password reset message to make sure the link still works in all cases when we convert emails to HTML.
* BUG FIX/ENHANCEMENT: Added reCAPTCHA v3 and invisible reCAPTCHA support. It is recommended sites using Stripe or Braintree update to the reCAPTCHA v3 option. Read more here: https://www.paidmembershipspro.com/pmpro-update-2-0-5/
* REFACTOR: Now running the pmpro_billing_preheader hook after the jquery.creditCardValidator script is enqueued in preheader/billing.php to match how we do it in preheader/checkout.php. (Thanks, Rafe Colton)

= 2.0.4 - 2019-01-14 =
* BUG FIX: Fixed warning in code added in 2.0.3 that could cause issues at checkout.
* BUG FIX: Setting priority of pmpro_check_admin_capabilities to 5 to ensure it runs before dashboard redirect.
* BUG FIX: Removed duplicate id attribute on the Membership Account page "cancel" action link.
* BUG FIX/PERFORMANCE: No longer enqueueing frontend.blocks.js which had no functional code, but loaded a lot of Gutenberg JS that wasn't needed on the frontend. When/if our blogs have frontend JS, we will load it again, but also make sure the dependencies are correct.
* BUG FIX/PERFORMANCE: No longer loading blocks.style.css. These frontend styles were redundant with CSS in css/frontend.css.
* NOTE: The SVN repository was missing the 2.0.3 tag when that update went out. Some users may have updated or tried to update and not gotten the correct files for 2.0.3. Everyone should update to 2.0.4, which is Gucci.

= 2.0.3 - 2019-01-11 =
* BUG FIX: Fixed issue where code in the Stripe gateway was cancelling old subscriptions early if users renewed with a different gateway. NOTE: There was a fix for this in version 2.0, but it wasn't implemented fully.
* BUG FIX: Filtering pmpro_other_order_ids_to_cancel to make sure the current checkout's order doesn't get cancelled. This started happening in version 2.0 since we started setting the user_id on orders for existing users before the checkout was fully processed. This fix along with the one above and others will fix cases where users were being cancelled immediately after checkout.
* BUG FIX: Fixed warning on edit levels page by defaulting $confirmation_in_email to 0.

= 2.0.2 - 2019-01-10 =
* BUG FIX: Fixed issues when using non-US currencies. Using the pmpro_round_price function in a few places it was needed. Prepared for a later update that will increase the number of decimals on certain columns in the DB to 8 to support currencies like Bitcoin, but shelving the actual DB update for version 2.1.
* BUG FIX: Fixed issue where existing users who checked out could run into problems. Added a getMembershipLevelAtCheckout method to the MemberOrder class and using that during checkout. The getMembershipLevel method would see the user_id property of the order (added to orders at checkout in version 2.0) and lookup the level data from the pmpro_memberships_users table instead of using the pmpro_level global. Then gateways like PayPal Express (but others also) would use the wrong data when making calls to pmpro_isLevelRecurring/etc.
* BUG FIX: Fixed bug where a notice to deactivate the Better Logins Report plugin could show up for users who couldn't deactive the plugin.
* BUG FIX: Fixed bad translation in the membership_expired.html file of the French translation.
* BUG FIX: Fixed some strings on updated reports that weren't wrapped for translation.

= 2.0.1 - 2019-01-03 =
* BUG FIX: Fixed issue where the PMPro dashboard and reports pages would appear blank if certain other plugins were active.

= 2.0 - 2018-12-31 =
* SECURITY: Fixing how we escape things in the Memberships report SQL queries.
* BUG FIX: Fixed issue where code in the Stripe gateway was cancelling old subscriptions early if users renewed with a different gateway.
* BUG FIX: Fixed a warning on the Stripe Webhook service.
* BUG FIX/ENHANCEMENT: Removing unused images from core plugin.
* BUG FIX/ENHANCEMENT: Removed unused `getTimestamp` function.
* BUG FIX/ENHANCEMENT: Updated Braintree/PHP Library to 3.36.0
* BUG FIX/ENHANCEMENT: Prefixing Braintree plan name with `pmpro_#`
* BUG FIX/ENHANCEMENT: Better table naming in queries for Memberships and Sales reports.
* BUG FIX/ENHANCEMENT: Changing "blacklist" to "blocklist".
* BUG FIX/ENHANCEMENT: Changing the appearance of the Discount Code "Apply" button on checkout to look more like a text link.
* BUG FIX/ENHANCEMENT: Now calculating the next payment date with time, not SQL.
* BUG FIX/ENHANCEMENT: Updated the pmpro_next_payment method of Stripe to check if a customer is delinquent to avoid returning a next payment date in the future if the last payment failed.
* BUG FIX/ENHANCEMENT: Saving user ID in MemberOrder when a user already exists and they are checking out via an offsite gateway.
* BUG FIX/ENHANCEMENT: Updating Stripe Webhook and PayPal IPN Handler to send the cancelled level ID for better cancellation emails.
* BUG FIX/ENHANCEMENT: Brought back the Stripe Billing limit warnings. Here is a plugin to get billing limits working with Stripe https://github.com/strangerstudios/pmpro-stripe-billing-limits/blob/master/pmpro-stripe-billing-limits.php
* FEATURE: Gutenberg / v5.0 Editor Blocks for Paid Memberships Pro pages, the Checkout Button and Membership "shortcode" functionality.
* FEATURE: Added new "Dashboard" page and adjusted the entire menu structure for "Memberships".
* FEATURE: Created new compatibility checks and included compatability functions for Beaver Builder, Elementor, and SiteOrigin Page Builder.
* FEATURE: Added REST API routes for post membership access, and user membership level.
* FEATURE: Added option to include the level's Confirmation Message in the Confirmation Email.
* FEATURE: Added a filter by discount code to Memberships and Sales reports.
* FEATURE: Added a filter by discount code to the Orders admin page.
* FEATURE: Added a "Copy" option to discount codes.
* FEATURE: Now allowing you to edit or add a discount code to a single Order edit.
* FEATURE: Added the ability to export orders by discount code used.
* FEATURE: Added new file for deprecated functions or hooks.
* ENHANCEMENT: Moved "Memberships" menu page up in sidebar below Comments.
* ENHANCEMENT: Replaced the Visits, Views, Logins report with the "Better Logins Report" Add On functionality.
* ENHANCEMENT: Updating reports that use the Google Charts library to use the updated chart library (corechart.js).
* ENHANCEMENT: Reports admin page is now loading reports via the `add_meta_box` WordPress function.
* ENHANCEMENT: Added ability to filter membership reports for free or paid levels only.
* ENHANCEMENT: Setting a default level at checkout so that the page doesn't redirect to the Levels page.
* ENHANCEMENT: Showing the discount code used on the All Orders and single Order edit page.
* ENHANCEMENT: Added ability to filter Orders by Free (Orders equal to $0), Paid (Orders greater than $0)
* ENHANCEMENT: Now showing the Invoice's Order Status on the Membership Account page for orders (Paid, Pending or Refunded).
* ENHANCEMENT: Adding additional quick search links when no members are found in members list search.
* ENHANCEMENT: Added a check on the Add Ons page to hide Add Ons that are no longer supported or recommended.
* ENHANCEMENT: Improved Responsive layout of the Memberships admin area for smaller devices.
* ENHANCEMENT: Adding .gitattributes and gitignore. Important now for node stuff in particular.

= 1.9.5.6 - 2018-11-15 =
* BUG FIX: Fixed issue where Braintree would try to cancel a subscription twice if it was cancelled on the Braintree side.
* BUG FIX: Fixed bug in Braintree webhook when using certain versions of PHP.
* BUG FIX: Correct Braintree plans flagged as faulty.
* BUG FIX/ENHANCEMENT: Added Order Code to the Orders Export CSV
* BUG FIX/ENHANCEMENT: Removed another warning RE billing limits with the Stripe gateway. (Thanks, Jordan Kohl)
* ENHANCEMENT: Added the pmpro_include_pricing_fields filter.
* ENHANCEMENT: Adding IDs to action links in the account shortcode so users can target them with CSS/JS.
* ENHANCEMENT: Updated French Translation. (Thanks, Pascal)
* ENHANCEMENT: Retina logo on dashboard pages.
* ENHANCEMENT: Showing what PMPro page a page is in the Post List table of the WP dashboard.

= 1.9.5.5 - 2018-10-19 =
* BUG FIX: Fixed fatal error in the Braintree webhook that will have caused syncing issues for Braintree users.
* BUG FIX: Stopped sending the cancel subscription request to the PayPal API if we are processing the IPN request for the same subscription.
* BUG FIX: Fixed issue where the Stripe API version was shown for non-Stripe gateways on the payment settings page.
* BUG FIX: Using self:: instead of static:: in the Stripe class that could keep the pmpro_stripe_customerid from being updated.
* BUG FIX: Fixed some fatal errors in PHP 5.2. (We still recommend a minimum PHP 5.6.)
* BUG FIX/ENHANCEMENT: Removed a unnecessary <hr> element when viewing the table of all active memberships.
* BUG FIX/ENHANCEMENT: Cleaned up some CSS code around buttons.
* BUG FIX/ENHANCEMENT: Added formatting for the Danish Krone.
* BUG FIX/ENHANCEMENT: Removed the warning RE billing limits with the Stripe gateway. Our Stripe implementation has actually supported billing limits for a while.
* ENHANCEMENT: Added Kenyan Shilling as a currency. (Thanks, Urandu Bildad Namawa)
* ENHANCEMENT: Updated the description, url, email, and copyright info in the plugin header.
* ENHANCEMENT: Now showing a note on the pages list in the dashboard if a page is linked to a PMPro page.
* ENHANCEMENT: Improving logo and watermark in the dashboard for retina displays.

= 1.9.5.4 - 2018-09-10 =
* SECURITY: Some values used in SQL queries in our reporting code were sanitized but not later escaped via esc_sql(). All variables added to SQL queries in the reports are now wrapped in esc_sql(). The previous code was not vulnerable to any known attack, but this change hardens the code against vulnerabilities in the case other parts of the code change in the future.
* BUG FIX: Fixed issue with lost passwords when Theme My Login 7 is active. (Thanks, Jeff Farthing)
* BUG FIX: No longer sending an "error canceling the subscription" email when subscriptions are cancelled from Stripe.
* BUG FIX: Fixed issue where TwoCheckout orders were not correctly updating the TOS consent data. (Thanks, Charl P. Botha)
* BUG FIX: Fixed issue where privacy function weren't defaulting to $current_user correctly. In practice, we were always passing a user_id anyway.
* BUG FIX/ENHANCEMENT: Changed the confirmation message to use wpautop instead of apply_filters('the_content'). If you were relying on shortcodes or other content that required that filter, you use add_filter('pmpro_level_description', 'the_content') to revert this for your site.
* BUG FIX/ENHANCEMENT: Using the strict parameter of sanitize_user when getting usernames. This will prevent some special characters from being used in usernames at checkout. This is inline with WP core and other plugins. (Thanks, David Cervantes Caballero)
* ENHANCEMENT: Added a breakdown of orders at each price point to the Sales Report widget
* ENHANCEMENT: Showing the Stripe version we use on the Payment Settings page.
* ENHANCEMENT: Updated Copyright date and GPLv2 link in license.txt.

= 1.9.5.3 - 2018-06-26 =
* BUG FIX: The pmpro_ipnhandler_extend_memberships function actually needed use $user_id instead of $current_user.

= 1.9.5.2 - 2018-06-26 =
* BUG FIX: Fixed compatibility with Theme My Login version 7. (Thanks, Jeff Farthing)
* BUG FIX: Fixed missing $current_user bug in pmpro_ipnhandler_level_extend_memberships function. (Thanks, Anne)

= 1.9.5.1 - 2018-06-08 =
* BUG FIX: Fixed issue with the PayPal IPN Handler where existing users checking out for a new level would sometimes have their membership and new subscription cancelled.
* BUG FIX: Fixed PayPal IPN Handler to set the status of old levels to 'changed' (instead of 'inactive') when processing checkouts. This will improve the accuracy of reports.
* BUG FIX/ENHANCEMENT: Now checking for the recurring_payment_skipped transaction type in the PayPal IPN handler. When a payment is skipped and this message is sent, we will now fire off the failed payment email to the customer and admin. (Thanks, mjulian87 on GitHub)
* ENHANCEMENT: Removed validation info from the IPN log.
* ENHANCEMENT: Updated German (de_DE) language files.

= 1.9.5 - 2018-05-24 =
* BUG FIX: Added 'error' to the list of default order statuses.
* BUG FIX: Fixed issue where PayPal recurring_payment messages with status "Pending" were treated as "Failed" by our IPN handler. (Thanks, Matt Julian)
* BUG FIX: The redirect away from the billing page needed to be in the preheader instead of the page shortcode.
* BUG FIX/ENHANCEMENT: Using the pmpro_getOrderStatuses() function in adminpages/orders.php instead of redundant code there.
* BUG FIX/ENHANCEMENT: Passing the $order as a second parameter to pmpro_after_checkout when called from the PayPal IPN handler. (The $order was being passed already for "regular" checkouts.)
* ENHANCEMENT: You can now sort by the Membership Level column added to the users list in the dashboard. (Thanks, Matt Julian)
* FEATURE: Added support for the privacy features added in WP 4.9.6. Details below.
* FEATURE: Added suggest privacy page text.
* FEATURE: Added PMPro-related user meta fields, membership history, and order history to the personal data export. You can filter which user meta fields are included in the export using the new pmpro_get_personal_user_meta_fields filter.
* FEATURE: Deleting PMPro-related personal data fields when personal data is erased. The ereaser deletes a number of user meta fields (filterable through the new pmpro_get_personal_user_meta_fields_to_erase filter). A user's membership history and order history are retained unless the user is deleted.
* FEATURE: Now saving a log of when the TOS page is agreed to at checkout. The ID and date modified of the TOS post is saved along with a timestamp of when the TOS was agreed to. This information is shown on the single order page in the admin, the orders CSV export, and on the edit user profile page in the admin. Note that this feature does not yet backport any data for existing users or ask users to re-agree to the TOS if the TOS has gone out of date.

= 1.9.4.4 - 2018-03-14 =
* BUG FIX: Updated the filters to extend membership levels to use the new pmpro_getSpecificMembershipLevelForUser() function to avoid bugs when MMPU is enabled.
* BUG FIX: Fixed cases where certain email templates were resulting in the body of the email being duplicated.
* BUG FIX: Fixed conflict with pmpro-email-templates when emails were disabled (the pmpro_email filter returns false). (Thanks, Mathieu Hays)
* BUG FIX: Now updating status on related subscription orders BEFORE canceling at gateway to avoid cases where the webhook sent by the gateway after canceling the subscription triggers further cancellation attempts.
* BUG FIX: No longer showing the "Stripe Publishable Key appears incorrect" error message if the key field is blank.
* ENHANCEMENT: Added the pmpro_getSpecificMembershipLevelForUser( $user_id, $level_id ) function for cases where MMPU is enabled and you want data about a specific membership level a user might have.
* ENHANCEMENT: Changed labels on the reCAPTCHA settings to match their current terminology: Site Key and Secret Key.

= 1.9.4.3 - 2018-01-04 =
* BUG FIX: Fixed issue where PMPro would attempt to cancel gateway subscriptions more than once in some cases.

= 1.9.4.2 - 2017-12-07 =
* BUG FIX: Avoid double-encoding the API version in PayPal Standard gateway
* BUG FIX: The update billing page now checks the gateway of the user's last order instead of the default gateway settings in case multiple gateways are in use or the default gateway has changed.
* BUG FIX: Fixed bug where discount codes were not being applied properly if the pmpro_default_level custom field was set and used on a page.
* BUG FIX: Credit card expiration emails were being to sent to members with PayPal Express orders.
* BUG FIX: Now correctly unslashing instructions for the check gateway.
* BUG FIX: Fixed issue with creating pages from the page settings page.
* BUG FIX/ENHANCEMENT: Improved submit button and processing message position for default and RTL on checkout page.
* BUG FIX/ENHANCEMENT: Added invoice total and total billed breakdown back to confirmation and invoice single views.
* BUG FIX/ENHANCEMENT: Avoid double-encoding the PayPal API version number
* ENHANCEMENT: Improved submit button and processing message position for default and RTL on checkout page.
* ENHANCEMENT: Switched order of Publishable and Secret Key fields and added validation check.
* ENHANCEMENT: Conditionally update members list headings for expired, cancelled, or old members.

= 1.9.4.1 - 2017-10-31 =
* BUG FIX: Fixed serious bug where payment fields weren't showing up for the Braintree gateway.
* BUG FIX: Fixed issue where Braintree webhook notifications were failing. We now allow the Braintree library to sanitize the incoming data since our sanitizing efforts were breaking the validation.
* BUG FIX/ENHANCEMENT: The webhook URL given for Braintree now goes through admin-ajax.php instead of a direct link to a php file within our plugin.
* BUG FIX/ENHANCEMENT: Updates to the Recaptcha library. (Thanks, Corin Simpson-Bryars)
* ENHANCEMENT: Made the cancelation failed error email easier to read.

= 1.9.4 - 2017-10-26 =
* BUG FIX: Fixed issue where PayPal was not working for amounts over $1000.
* BUG FIX: Non-decimal currencies now handled correctly with Stripe.
* BUG FIX: Fixed issue where updating a Stripe subscription from the edit user page could cancel the subscription once the webhook fired.
* BUG FIX: Fixed issue where "admin_cancelled" memberships weren't being calculated correctly in membership reports.
* BUG FIX: Fixed issue where users could not drag and drop to change the order of membership levels.
* BUG FIX: pmpro_getMembershipLevelsForUser() would sometimes return duplicate levels in the array if the user had multiple active entries in the pmpro_memberships_users table.
* BUG FIX: Updated includes/metaboxes.php to call pmpro_getAllLevels() instead of relying on the $membership_levels global which is problematic.
* BUG FIX: Fixed a few strings that weren't wrapped for translation or were using the old text domain.
* BUG FIX: Fixed redirect error that occured when the levels page was not set.
* BUG FIX: Updated getfile.php to support file names with urlencoded characters (e.g. spaces) in them. (Thanks, florent from PMPro blog)
* BUG FIX: Fixed notice when use the getfile.php script due to using add_filter instead of apply_filters in the mimetype class.
* BUG FIX: Fixed the all time views column for the logins report.
* BUG FIX: Fixed fatal error on the logins report, member shortcode and other issues when using PHP7.1+.
* BUG FIX: Fixed issue with saving arrays using pmpro_setOption()
up the lines of text.
* BUG FIX: Fixed typo in the string "Are you sure you want to do that? Try again."
* BUG FIX: Fixed a few strings that used the wrong text domain or weren't wrapped correclty for translation.
* BUG FIX/ENHANCEMENT: Now bundling Google's jsapi.js file for use in the reports.
* BUG FIX/ENHANCEMENT: Fixed issue where some emails (e.g. the password reset email) would not have wpautop applied to them, crunching
* BUG FIX/ENHANCEMENT: Better checking for Theme My Login compatibility when handling login redirects.
* BUG FIX/ENHANCEMENT: Better error handling for Braintree.
* BUG FIX/ENHANCEMENT: Membership stats widget now shows first 3 levels based on level order.
* BUG FIX/ENHANCEMENT: Added the pmpro_member_shortcode_access filter
* ENHANCEMENT: Updated the Stripe PHP library to version 5.2.2 and updated Stripe to use the latest version of their API, 2017-08-15.
* ENHANCEMENT: Changed frontend pages (e.g. checkout.php) to use a div-based layout instead of tables. Important information here if you are using custom page templates or notice UI issues after upgrading:
* ENHANCEMENT: Added pagination to the discount codes page in the admin. Also sorting codes in descending order by ID. Use the pmpro_discount_codes_per_page filter to change the per page limit from 15.
* ENHANCEMENT: Updated plugin admin pages with better links to documentation and support.
* ENHANCEMENT: Updated plugin frontend pages checkout, billing, confirmation, and single invoice to remove most table based layouts.
* ENHANCEMENT: Better error message if trying to checkout using an existing user's email address.
* ENHANCEMENT: Added the pmpro_report_levels filter to let users change levels and order of levels for the memberships.php report.
* ENHANCEMENT: Updated video and copy for readme.txt.
* ENHANCEMENT: Added user display name to Memberlist search query
* ENHANCEMENT: Added Russian Ruble as a currency.
* ENHANCEMENT: Changed the dated term "CVV" to "Security Code (CVC)" when shown on the frontend.
* ENHANCEMENT: Added .doc and .docx to the mimetype class.
* ENHANCEMENT: Added Portuguese language files. (Thanks, Secundino Correia)
* ENHANCEMENT: Updated plugin admin pages with better links to documentation and support.

= 1.9.3 - 2017-07-06 =
* SECURITY: Fixed sanitization of inputs and added nonces in several places to protect against XSS attacks.
* BUG FIX: Showing correct error message when trying to update a PMPro Plus add on with a Core license installed.
* BUG FIX: Fixed issue where subscription and payment transaction IDs were not being saved correctly when copying an order in the dashboard. (Thanks, Pippin Williamson)
* BUG FIX: Fixed fatal errors that occurred in certain PHP versions.
* BUG FIX: Fixed issue where ProfileStartDate was being calculated incorrectly in the test, check, and Cybersource gateways.(Thanks, David Parker)
* ENHANCEMENT: Added a pmpro_sanitize_with_safelist() function that is used to sanitize inputs that have a limited number of exact options.
* ENHANCEMENT: Updated the pmpro_setOption() and pmpro_getParam() functions to take a new last parameter $sanitize_function, which defaults to 'sanitize_text_field'.

= 1.9.2.2 - 2017-06-13 =
* BUG FIX: Fixed warnings on the Network Dashboard's sites page.
* BUG FIX: Skipping update scripts that require the Stripe library if the system doesn't support the minimum requirements for the Stripe API. This avoids warnings and errors during upgrade.

= 1.9.2.1 - 2017-06-05 =
* BUG FIX: Fixed issues with activation on single sites.
* BUG FIX: Starting PHP sessions earlier to fix issues with PayPal/PayPal Express checkouts.

= 1.9.2 - 2017-06-03 =
* BUG FIX: Fixed issue where Braintree checkouts were failing with a CVV error when existing users checked out.
* BUG FIX: Fixed issue loading the Stripe library in PHP 5.6.
* BUG FIX: Member List CSV export was ignoring search parameter.
* BUG FIX: Discount codes weren't being remembered during the "review" step of a PayPal Express checkout. (Thanks, Rafe Colton)
* ENHANCEMENT/FIX: Search Filter would trigger incorrectly for REST API request by slug.
* ENHANCEMENT/FIX: Didn't always identify MasterCard cards correctly to set the CardType with some gateways.
* ENHANCEMENT/FIX: Some custom code or add ons (e.g. the Prorating and Auto-renewal Checkbox add ons) would sometimes break PayPal Website Payments Pro and PayPal Express subscriptions by trying to set the "Profile Start Date" longer than 1 year out. We now limit the Profile Start Date to 1 year out and try to squeeze up to 1 additional year into a trial if it's not already being used. This bug affects PayPal Standard as well, but the fix is different and not included in this release.
* ENHANCEMENT: Tested up to WordPress 4.8.
* ENHANCEMENT: Made countries translatable.
* ENHANCEMENT: Improved performance via PHP $_SESSION management improvements. We now only open the session before we set session vars and close the session when we are finished with it.
* ENHANCEMENT: Added to code to stop network activation of Paid Memberships Pro. (Thanks, Paul Barthmaier)

= 1.9.1 - 2017-05-11 =
* BUG FIX: Fixed the code checking if the Stripe library is already loaded to compatability issues with other plugins bundling the Stripe API library.
* BUG FIX: Cancel code now properly uses preg_replace when sanitizing the list of level ids to cancel.
* FIX/ENHANCEMENT: Removed test/doc code from Stripe and Braintree libraries.
* ENHANCEMENT: Now pausing the license nag for the first week of use and removed the "invalid" error if no key is being used.

= 1.9 - 2017-04-26 =
* BUG: Fixed issue with cancelling 2Checkout recurring subscriptions. Now using the payment_transaction_id to find/cancel the sale's recurring subscription since no subscription_transaction_id is being saved.
* BUG: Fixed issue where old membership levels were not listed correctly in the cancellation email. (Thanks, Mike from Migrating Eye)
* BUG: Fixed issue where "custom trial" values were not saving for discount codes.
* BUG: Fixed issue where checkouts were still processing even if there were errors with the discount code used.
* BUG: Fixed bug where settings added via the pmpro_custom_advanced_settings were not being saved to DB unless they were prefixed with custom_.
* BUG: Fixed other formatting issues with settings added via pmpro_custom_advanced_settings.
* BUG: Fixed issue where the sendInvoiceEmail method of the email class was expecting $order->discount_code to be a string, but it was sometimes a discount code object. (Thanks, Bill Stoltz)
* FEATURE: Added the pmpro_member shortcode. See the Paid Memberships Pro website for documentation.
* ENHANCEMENT: Added pmpro_account_membership_expiration_text filter to filter the expiration text that shows ona  user's membership account page.
* ENHANCEMENT: Updated our Stripe and Braintree libraries to use their latest versions. This update allows our gateway integrations to support PHP7 and also removes support for PHP 5.2 and 5.3.
* ENHANCEMENT: The Braintree level compatibility check now also looks for a properly named plan.
* ENHANCEMENT: Better error handling when trying to update plugins that update against the PMPro license server.
* ENHANCEMENT: Improved Italian translation. (Thanks, Francesco Pezzotti)
* ENHANCEMENT: Improved German tranlsation. (Thanks, Simon)
* ENHANCEMENT: Added a Sweedish tranlsation. (Thanks, Mathias Persson)
* ENHANCEMENT: Added a "Chinese/Cantonese (Hong Kong SAR China)" tranlsation. (Thanks, Kai Chan)

= 1.8.13.6 =
* BUG: Fixed bug where credit card expiration emails would be sent to users with PayPal Express orders.
* BUG: Fixed bug when updating billing with Stripe.
* BUG: Fixed bug where the archive/search filter was not running for logged out users.
* ENHANCEMENT: Updated Finnish translations. (Thanks, JP Jakonen)
* ENHANCEMENT: Added filter for modifying the order description in Stripe. (Thanks, Rafe Colton)

= 1.8.13.5 =
* BUG: Fixed notifications.php to make sure it really only checks once per day. Also updated the URL checked to notifications.paidmembershipspro.com, which runs on its own server.

= 1.8.13.4 =
* BUG/ENHANCEMENT: Changed the pmpro_button shortcode to pmpro_checkout_button. (The old pmpro_button will also still work. checkout_button works if you have Register Helper installed.)

= 1.8.13.3 =
* BUG: Fixed bug when using a secondary gateway (e.g. PayPal Express) with Stripe as your primary gateway.

= 1.8.13.2 =
* BUG: Fixed bug with updating credit cards through Braintree.
* BUG: Fixed bug with updating credit cards through Stripe.
* BUG: Fixed SQL warnings when generating the pmpro_membership_levelmeta table. (Thanks, itibet on GitHub)
* BUG/ENHANCEMENT: Moved some update billing and checkout related code from the preheaders and page templates into the Braintree and Stripe classes.
* ENHANCEMENT: Added pmpro_billing_order filter that functions similar to pmpro_checkout_order.
* ENHANCEMENT: Added pmpro_billing_before_submit_button hook that functions similar to the pmpro_checkout_before_submit_button hook.
* ENHANCEMENT: Clicking on a report widget no longer takes you to the details page. You have to click the details button. This allows us to add additional functionality to the widgets.
* ENHANCEMENT: Updated reports widgets so the "details" button only shows if a page function is defined for that report. You can now have report widgets without details pages.
* ENHANCEMENT: You can now click on a heading in the Membership Stats report widget to see data for up to 3 of your levels. The first 3 levels per the level ordering are shown.

= 1.8.13.1 =
* BUG: Fixed issue where end dates were being set/saved incorrectly from the edit user/profile page in the dashboard.
* BUG: Fixed warnings in the Braintree PHP library. (Thanks, Travis Shivers)
* BUG: Fixed issue where the filtered $mypost object was not being used in the content filter if the post type was "page". (Thanks, James)
* BUG: Removed the extra class="input" attribute on the CVV field when the Stripe gateway is used. (Thanks, Rafe Colton)
* BUG/ENHANCEMENT: Changed the number of X placeholders for masked credit cards to 12 (+ the last 4 stored) instead of 13. (Thanks, Rafe Colton)

= 1.8.13 =
* FEATURE: The Stripe Webhook has been updated to process subscriptions cancelled from Stripe. PMPro will now cancel memberships for these users instead of sending an email to the admin.
* BUG: Fixed various bugs in the PayPal IPN handler.
* BUG: Fixed search on discount codes page in dashboard. (Thanks, Debjit Saha)
* BUG: Fixed bug in Cancellations report where all-time cancellations were always 0.
* BUG: Fixed link to payment settings on checkout notice. (Thanks, Coen Jacobs)
* BUG: Timezone magic on edit user page in the dashboard to make sure the expiration date you select is the one set.
* BUG: Swapped out deprecated uses of eregi_replace and split.
* BUG/ENHANCEMENT: Now using add_query_arg in the pmpro_url() function. (Thanks, Debjit Saha)
* ENHANCEMENT: Updating stylesheet for WordPress 4.7 and new Twenty Seventeen theme support.
* ENHANCEMENT: Now longer warning of membership levels with cycle numbers > 1 when using the Payflow Pro gateway since Payflow now supports cycle numbers (frequencies) > 1.
* ENHANCEMENT: Updated da_DK translation. (Thanks, bopdoq on GitHub)
* ENHANCEMENT: Added pmpro_include_payment_option_for_paypal filter, which can be set to false to use PayPal WPP without the PayPal Express option.
* ENHANCEMENT: Better dependency checking for Stripe and Braintree gateways.
* ENHANCEMENT: Updated IPN handler and Stripe Webhook handler to use pmpro_cancelMembershipLevel instead of pmpro_changeMembershipLevele. This improves support for the MMPU addon.

= 1.8.12.1 =
* BUG: Fixed bug when using the testing gateway.
* BUG: Avoiding issues where is_user_logged in is not yet available for the pmpro_search_filter() function. (Thanks, d_enajetic)
* ENHANCEMENT: Updated Italian translation. (Thanks again, Angelo)
* ENHANCEMENT: You can now define('PMPRO_USE_SESSIONS', false); in your wp-config.php to force PMPro to skip the call to session_start. Note that PayPal Express and some addons require sessions to function.

= 1.8.12 =
* BUG: Fixed issue where "expiring soon" emails were sometimes sent more than needed.
* BUG: Fixed issue where PayPal Standard IPN requests were being rejected if a tax amount was set in PayPal.
* BUG: Fixed issue with Stripe subscription "updates" that were set to fire on "next payment", e.g. if you used Stripe with levels with a non-zero trial amount. When the update processed and created a new subscription, the old subscription was not being deleted and the new subscription ID was not being saved as a new order for future tracking purposes. If you use this feature, please check in Stripe to make sure your users don't have extra subscriptions.
* BUG: Fixed setting in PayPal/PayPal Express API calls from AUTOBILLAMT to AUTOBILLOUTAMT. This setting is set to AddToNextBilling, meaning that failed payment amounts are added to the next billing cycle's amount if left unpaid. In most cases, a retry of the original billed amount goes through or the user's subscription is cancelled. But just in case, this makes sure that outstanding balances are paid. (Thanks, jubstuff on GitHub)
* BUG: Fixed warnings in the setGateway method of the MemberOrder class for cases where the gateway is missing or the class file is not found.
* BUG/ENHANCEMENT: Moved the pmpro_before_change_membership_level hook to fire a little bit earlier to make it easier to determine the old level status/end date/etc before it gets updated. (Thanks, MrVibe on GitHub)
* ENHANCEMENT: Replaced the Force SSL option with an explanation if the entire site is over HTTPS. We are already ignoring the option in these cases.

= 1.8.11.2 =
* BUG: Fixed a bug introduced in 1.8.11 that kept PMPro from tracking coupon code uses. Any checkout with a discount code while running 1.8.11 won't have properly tracked the discount code use. You may want to adjust your "uses" numbers for your codes, and hand check any reporting/etc that relied on discount codes. Users of the Sponsored Members addon will have been affected too. Discount codes will need to be made manually for any sponsor who checked out.
* BUG: Fix to the expiration warnings code. Making sure it finds all members who are expiring soon while also keeping track of when emails are sent so users don't get too many emails.
* BUG: Fixed issue where pmpro_before_change_membership_level was running after levels had been changed.
* BUG: Fixed some warnings.
* ENHANCEMENT: Updated Italian translations. (Thanks, Angelo)

= 1.8.11.1 =
* BUG: Fixed issue introduced in 1.8.11 where the pmpro_default_level custom field was being ignored at checkout.
* BUG: Fixed bugs in DB calls made for the compatibility checks for various gateways.
* BUG: Now sending a FREQUENCY parameter for PayPal Payflow orders.

= 1.8.11 =
* BUG: Fixed URL used when checking for addon updates.
* BUG: Now enqueueing the jquery.creditCardValidator.js file in Billing preheader.
* BUG: Fixed issues where PayPal IPN updates would sometimes log $0 instead of the actual billing amount.
* BUG: Fixed warnings in the PayPal IPN handler.
* BUG/ENHANCEMENT: Added pmpro_checkout_level filter and now using that filter to apply the_content filters to the level description at checkout. This allows you to turn off the the_content filters (e.g. processing shortcodes) by using remove_filter('pmpro_checkout_level', 'pmpro_pmpro_checkout_level'); in a custom plugin.
* BUG/ENHANCEMENT: Using the pmpro_confirmation_message filter on the confirmation page whether there is an invoice or not. Now also adding the the_content filters to the confirmation message. You can disable this by using remove_filter('pmpro_confirmation_message', 'pmpro_pmpro_confirmation_message'); in a custom plugin.
* ENHANCEMENT: Now tracking IPN event ids in order notes for recurring orders.
* ENHANCEMENT: Added pmpro_subscription_ipn_event_processed hook to IPN handler.
* ENHANCEMENT: Added pmpro_set_message filter to edit PMPro error messages. Passes the message and type.
* ENHANCEMENT: Now listing categories in hierarchical format in the Content Settings section of Membership Levels.
* ENHANCEMENT: Added pmpro_areLevelsFree() function to check if all levels in an array of levels are free.
* ENHANCEMENT: Added pmpro_getLevelsCost() - with an s - function to get the combined cost of multiple levels in an array.
* ENHANCEMENT: Added pmpro_getLevelsExpiration() - with an s - function to get the combined expiration text for multiple levels in array.
* ENHANCEMENT: Created the pmpro_getLevelAtCheckout function that modularizes some of the logic of creating the pmpro_level global at checkout.
* ENHANCEMENT: Added pmpro_members_list_user filter used on the admin members list and members list CSV export.
* ENHANCEMENT: Added a 4th parameter $cancel_level to pmpro_changeMembershipLevel(). If set, that level will definitely be cancelled locally and at the gateway. This parameter is also passed to the pmpro_before_change_membership_level and pmpro_after_change_membership_level hook.
* ENHANCEMENT: Added a new function pmpro_cancelMembershipLevel($level_id, $user_id, $old_level_status) that acts as a wrapper to pass the $cancel_level param to pmpro_changeMembershipLevel().
* ENHANCEMENT: Updated the cancel page on the frontend to support the Multiple Memberships per User addon. All memberships are shown. You can cancel individual memberships separately. The language of the confirm button mentions memberships vs account.
* ENHANCEMENT: Added pmpro_getMemberOrdersByCheckoutID($checkout_id) function to support Multiple Memberships per User and others using the checkout_id.
* ENHANCEMENT: Added a refund($order, $transaction_id) method to the PMPro_stripe class. This will be used by the Multiple Memberships per User addon and eventually used in other areas by the core pluginn.

= 1.8.10.4 =
* BUG: Fixed issue where non-decimal currencies (e.g. Japanese Yen) were sending invalid amounts to the Stripe gateway.
* BUG/ENHANCEMENT: If an invalid discount code is applied at checkout, we now set the code_level JS var to false. Along with updates to the Pay by Check addon, this fixes issues with the Pay by Check addon where users could not checkout when using a discount code that reduced the price to free.
* BUG/ENHANCEMENT: Fixed HTML validation issue in CVV field of the checkout page.
* BUG/ENHANCEMENT: Now using the current_time function in profile.php to avoid off-by-one errors when changing members' expiration dates.

= 1.8.10.3 =
* BUG: Fixed bug where users could not confirm PayPal Express payments if the main gateway was Stripe or Braintree.
* BUG: Fixed issue where the billing address and/or credit card fields were not showing up on the Update Billing page.

= 1.8.10.2 =
* BUG: Fixed bug in invoices query in the pmpro_account shortcode.
* BUG: Fixed issue where the orders table was not being created on brand new installs.
* BUG: Fixed responsive styling of ReCaptcha.
* ENHANCEMENT: Added Hebrew language support. Thanks, Nadav Waisbrod.
* ENHANCEMENT: Update to Italian translation. (Thanks again, Angelo Giammarresi)
* ENHANCEMENT: Added a text domain and path to the plugin header.

= 1.8.10.1 =
* BUG: Fixed bugs in pmpro_hasMembershipLevel that caused shortcodes like [membership levels="0"] and [membership levels="-1"] to stop working.

= 1.8.10 =
* SECURITY: Patched a cross site scripting (XSS) vulnerability on the Memberships -> Addons page in the dashboard. Thanks to Burak Kelebek for the discovery and responsible disclosure of this vulnerability.
* BUG: Added pmpro_btn-submit-checkout class to the PayPal checkout buttons.
* BUG: Updated Stripe and Braintree gateways to load billing fields and JavaScript when it's the default gateway (if not the current gateway specified).
* BUG: Fixed bug where cancelation emails weren't being sent to users if they originated from PayPal.
* BUG: Fixed bug where unsucessful invoices were shown on the Membership Account page. We aren't showing refunded invoices here now either, but plan to in the future.
* BUG: The update billing page now uses the pmpro_include_billing_address_fields filter so gateways and addons can properly override the payment fields when needed.
* BUG: The update billing page now uses the validatecreditcard.js script to set the Card Type in the background, just like checkout. Fixes some issues with updating credit cards on certain gateways.
* BUG: Reintroduced the pmpro_members_list_sql filter.
* BUG/ENHANCEMENT: Switched the Japanese Yen and South Korean Won to not use decimals by default. (Thanks, flatworld21 on wp.org)
* ENHANCEMENT: Added an option to skip the confirmation step with PayPal Express.
* ENHANCEMENT: Added the pmpro_membership_levels_table filter on the membership levels page of the dashboard to allow addons (like the upcoming MMPU addon) to override the HTML for the table shown.
* ENHANCEMENT: Added the checkout_id column to the pmpro_membership_orders table. This will be used by addons and possible core in the future to track multiple orders that happen during the same checkout process.
* ENHANCEMENT: Added support for the Serian language. (Thanks, Sasa Trifkovic)
* NOTE: We are planning to remove the certificate_id and certificate_amount columns from the pmpro_membership_orders table. Please contact us if you are using this column for something to come up with a work around.

= 1.8.9.3 =
* BUG: Fixed bug introduced in 1.8.9.2 where member start and end dates weren't being set correctly. Includes an update script to fix past users affected by this.
* BUG: Fixed warnings on new order page in the dashboard.
* BUG/ENHANCEMENT: Fixed the pmpro_checkout_default_submit_button() methods of the PayPal Express to no longer check if the current gateway is a paypal one. The method is only called when the gateway is loaded anyway or when another addon (e.g. the pmpro-pay-by-check addon) adds the hook.
* BUG/ENHANCEMENT: Moved check instructions code into the check gateway class so it can be overriden by addons (e.g. an update to the pmpro-pay-by-check addon).

= 1.8.9.2 =
* BUG: Fixed SQL in pmpro_changeMembershipLevel that caused issues with some MySQL setups.
* BUG: Fixed URL PayPal Express and PayPal standard redirect to at checkout. (Although the incorrect URL was still working on the PayPal side.)
* BUG: Addon page now passes $status to the plugin_row_meta filter to fix warnings that were sometimes showing up. (Thanks, jawhite)
* BUG: Fixed typo in the pmpro_orders_csv_extra_columns filter introduced in 1.8.9.1. (Thanks, Johannes Jokelin)

= 1.8.9.1 =
* BUG: Fixed bug where some recurring orders members who checked out with Stripe in very old versions of PMPro would show up as orders with a blank user_id and membership_id. This update includes a fix for this and an update script to fix old orders affected by this.
* BUG: Fixed bug where the Stripe class activation/deactivation methods were setup too late to actually run on activation/deactivation.
* BUG: Updated the Stripe class to use the same language and markup in the Payment Information section as the default checkout.
* BUG: Now forcing pmpro_getMembershipLevelForUser() in admin change emails.
* BUG: Fixed warning in comments_array and comments_open filters. (Thanks, Mihail Chepovskiy)
* BUG: Fixed format error for dates when saving orders. (Thanks, EmreErdogan)
* BUG: Fixed bug that was causing issues in the cancellations report.
* BUG: Fixed the pmpro_cron_expiration_warnings script to properly skip deleted and already expired members.
* BUG: Reverted code to generate the CVV popup URL.
* BUG: Fixed a couple bugs in the pmpro_loadTemplate function.
* BUG/ENHANCEMENT: Updated URL used in the IPN Handler API calls to match the latest PayPal docs. (Thanks, pbaylies)
* BUG/ENHANCEMENT: Overhauled the orders list CSV export for improved performance. There is still scaling work to be done on the exports, but timeouts and memory errors will happen much less often.
* ENHANCEMENT: Added Greek (el_GR) translation. (Thanks, Alexandros Karypidis)
* ENHANCEMENT: Added $order as a parameter to the pmpro_orders_user_row_actions hook. (Thanks, SquareLines)
* ENHANCEMENT: Added a warning to backup your database to the update notice.

= 1.8.9 =
* BUG: Fixed bug with recurring orders and TwoCheckout.
* BUG: Fixed bug where some non-members (membership_id was 0 or NULL) were being processed for expiration.
* BUG: Fixed bug where the address/street wasn't showing up when printing orders from the dashboard.
* BUG: Fixed bug where the Stripe class would sometimes show its billing and payment fields even if a secondary gateway was chosen.
* BUG: Making sure $this->total is set for new orders and available to the pmpro_add_order, pmpro_added_order filters.
* BUG: Fixed bug where email templates were not being loaded out of the /paid-memberships-pro/languages/email/ directory. (Thanks, menardmam on wordpress.org)
* BUG: No longer showing a "renew" link on the membership account or membership levels pages if the user's level is not allowing sign ups.
* BUG: Fixed bug where the expiration script might try to run on deleted or expired users.
* BUG/ENHANCEMENT: Change membership shortcode to call pmpro_hasMembershipLevel when checking for level="" as well. This ensures the pmpro_has_membership_level filter runs, which some addons/etc need.
* ENHANCEMENT: Updated categories list on the edit levels page to show nested categories.
* ENHANCEMENT: Now adding a pmpro-no-access class (similar to the pmpro-has-access class) to the post element if a user doesn't have access to that post.
* ENHANCEMENT: Added pmpro_checkout_end_date filter, similar to pmpro_checkout_start_date. Takes params $enddate, $user_id, $pmpro_level, $startdate.

= 1.8.8.3 =
* BUG: Fixed issue in pmpro_has_membership_access() that was causing issues on some sites, specifically sites running PMPro Series.

= 1.8.8.2 =
* BUG: Fixed bug with new order creation.

= 1.8.8.1 =
* BUG: Fixed issue in pmpro_has_membership_access() that kept member content from being locked down on blog homepages and archive/index pages.
* BUG: Fixed display of renew button for memberships with an enddate, but no expiration number or period (e.g. if an admin changed the enddate).
* BUG: Fixed issue where the subtotal was not being recorded properly for some new orders.
* BUG: Fixed issues some where having running the update scripts.

= 1.8.8 =
* BUG: Fixed issue where recurring Stripe orders were being created with $0 totals.
* BUG: Fixed issues in pmpro_has_membership_access() that was affecting some sites with files locked down for members. (Thanks, MannyC on GitHub)
* BUG: Fixed issue where data in the Signups vs Cancellations detailed view chart was shifted back one day. (Thanks, TYT)
* BUG: Fixed issue where whitespace in email addresses and user names could confuse the pre-existing user checks.
* BUG: Added some closing HTML tags where needed.
* BUG: Fixed issue where discount codes could be created with special characters even though only letters, numbers, and - will work at checkout.
* BUG: Some fixes to the pt_BR language. (Thanks, )
* ENHANCEMENT: Refactored the members list CSV to use less memory and scale better. It should work faster in general and better on large sites. (Thanks, Thomas Sjolshagen)
* ENHANCEMENT: Added pmpro_reports_signups_sql and pmpro_reports_get_cancellations_sql filters to filter SQL that generates cancellation numbers in reports.
* ENHANCEMENT: Now setting the timeout on PayPal API calls to 60 seconds from 5 seconds.
* ENHANCEMENT: Now checking admin capabilities on each load in the dashboard in case PMPro-related admin capabilities have been changed. This avoids issues where users were upgrading PMPro but wouldn't have access to updates or new features without deactivating and reactivating PMPro.
* ENHANCEMENT: Added a pmpro_paypal_level_description filter that can be used to filter the description of the level sent to PayPal.
* ENHANCEMENT: Added Catalan translations (ca, ca_AD, ca_ES). (Thanks, Jordi Martín)
* ENHANCEMENT: Added Estonian translations (et_EE). (Thanks, Enriko Ojala)

= 1.8.7.3 =
* BUG: Using HTTP 1.1 for calls to the PayPal API now.
* BUG: The pmpro_cron_credit_card_expiring_warnings cron job setup by PMPro needed a monthly schedule added via the cron_schedules filter.
* ENHANCEMENT: Added the pmpro_maybe_schedule_event() function. This checks if an event with the same hook and args is already scheduled before scheduling the new event.
* ENHANCEMENT: Added a script that will run on upgrade to clean out old cron jobs.

= 1.8.7.2 =
* BUG: Fixed bug where pmpro_activation() was firing on every page load. (Thanks, Tigertech and MegaZ on WordPress.org)
* BUG: Fixed bugs with internationalized date formats in a few places.

= 1.8.7.1 =
* BUG: Added missing files via svn.

= 1.8.7 =
* BUG: Fixed bug where recurring Stripe orders were saving the customer ID in the subscription_transaction_id instead of the subscription ID. This was causing issues with plugins like AffiliateWP that tried to track recurring orders. After upgrading to 1.8.7, a script will run on your database to fix old recurring orders.
* BUG: Fixed bug where cancellations weren't showing up in the chart views of the membership stats reports.
* BUG/ENHANCEMENT: The IPN service will now look for the payment_date parameter to set the timestamp of the recurring order/etc when processing IPN requests.
* ENHANCEMENT: Added tools to run large database updates (e.g. Stripe fix above) over AJAX to avoid timeouts.
* ENHANCEMENT: MemberOrder class will now insert/update the timestamp if a ->timestamp or ->datetime variable is set on the object.
* ENHANCEMENT: Updated the Norwegian translation. (Thanks, Thomas Sjolshagen)
* ENHANCEMENT: Added Argentine Peso (ARS) as a currency.
* ENHANCEMENT: Added Nigerian Naira as a currency option. (Thanks, Maria)
* ENHANCEMENT: Added a second option $conjunction parameter to the pmpro_implodeToEnglish() function. So you can use pmpro_implodeToEnglish($array, 'or') to change the 'and' in the text to 'or' or something different.
* ENHANCEMENT: The "Sales" numbers on the sales and revenue reports now only includes orders with totals > $0. (More reports updates in the works.)

= 1.8.6.8.1 =
* BUG: Fixed bug in the Payflow gateway class that was breaking API calls and checkout.

= 1.8.6.8 =
* BUG/ENHANCEMENT: Adding <!-- comment markup --> to inline JavaScript to avoid issues where themes/plugins were adding formatting into the JavaScript code. (Thanks, Isabelle Couillard)
* BUG: Removed calls to force_ssl_login(), which has been deprecated in WP 4.4+. We are using force_ssl_admin() instead.
* BUG: Fixed issue in pmpro_isLevelExpiringSoon() which controls when "renew" links are shown to users. (Thanks, Thomas Sjolshagen)
* ENHANCEMENT: Updated PayPal gateway classes to use the WP HTTP API instead of CURL directly.

= 1.8.6.7 =
* BUG: Fixed issue with prices over $1000 when using TwoCheckout. (Thanks, BigBradBrown and others.)
* ENHANCEMENT: Removed the API Private Key option from 2Checkout setup since we don't actually use that in the API.
* ENHANCEMENT: Using the pmpro_check_status_after_checkout filter to set the status of orders for recurring check payments in addition to one time payments. This update supports the update Pay by Check Add On v.5.
* ENHANCEMENT: Added +1 to timestamp when the pmpro_cron_expiration_warnings cron is scheduled to make sure it runs after the pmpro_cron_expire_memberships cron.
* ENHANCEMENT: Added email templates for Greek translation. (Thanks, Dimitris Kalliris)

= 1.8.6.6 =
* BUG: Fixed issue introduced in 1.8.6.5 where "Please enter all required fields" errors would show up even for free/etc levels at checkout.

= 1.8.6.5 =
* BUG: Now checking for required fields even if $pmpro_requirebilling is not set.
* BUG: The redirect_to URL is now encoded with urlencode() when using the !!referrer!! tag in the logged out/non-member text settings on the advanced settings tab. (Thanks, Robert Wilkins)
* BUG: Fixed issue where filters stopped working on the orders page in the dashboard.
* BUG: Fixed issue in pmpro_isLevelExpiringSoon that caused the "renew" link to not appear sometimes. (Thanks, xzistance3)
* BUG: Fixed wording of level cost text for levels with billing limits and billing periods with cycles > 1, e.g. "$1 now and then $1 every 2 Months for 2 periods". Thanks, russell77)

= 1.8.6.4 =
* BUG/ENHANCEMENT: Now expiring members before sending expiration warnings.
* BUG: Now adding a specific user agent to IPN requests to PayPal (and other gateways) to avoid 403 errors.
* ENHANCEMENT: Added a constant PMPRO_USER_AGENT used in all outside HTTP requests. The user agent will look like "Paid Memberships Pro v1.8.6.4;http://yourdomain.com".

= 1.8.6.3 =
* SECURITY: No longer showing email addresses in output when cron jobs are processed by non-admins. (Thanks, Daniel Bachhuber)
* BUG: Better handling of errors when validating PayPal IPN requests. Added pmpro_ipn_validate filter. PayPal users should read the release notes here: http://www.paidmembershipspro.com/2015/10/pmpro-update-1-8-6-3/
* BUG: Fixed bug where both the return and first order INS would change membership and update the order twice, leading to unwanted cancellations and emails. (Thanks, Steffen Dressler)
* BUG: No longer using the $pmpro_levels global in pages/levels.php.

= 1.8.6.2 =
* BUG: Stripe supports daily recurring subscriptions. Fixed issue where PMPro was still throwing a warning in some cases.
* BUG: Removed warnings in the membership stats report.
* CODE: Changed a couple instances of "since v2.0" to "since v1.8".
* ENHANCEMENT: Added a hook for pmpro_checkout_order_free that functions like pmpro_checkout_order but fires for the blank order created for free checkouts.
* ENHANCEMENT: Using site_url to get full URL to for the redirect_to value generated by !!referrer!! in the non-member/logged-out text strings in the advanced settings page. This fixes issues with using !!referrer!! on multisite setups. (Thanks, Keith Hall)
* ENHANCEMENT: Updated pmpro_post_classes to work on the $post_id passed by the filter instead of the global $post variable.
* ENHANCEMENT: Added pmpro_body_classes to add classes like pmpro-body-level-required, pmpro-body-level-1, and pmpro-body-has-access to the body tag based on the queried object.
* ENHANCEMENT: Reformatted the PMPro Reports dashboard.
* ENHANCEMENT: Now using separate invoice templates for email and print.

= 1.8.6.1 =
* SECURITY: Removed debug code from the PayPal IPN Handler script that was causing invalid IPN requests to process as if they were valid. (Thanks, Francois Harvey)

= 1.8.6 =
* BUG: The pmpro_membership_level_profile_fields_update() function now only fires on the personal_options_update and edit_user_profile_update hooks instead of the profile_update hook since this function expects to be called from the your-profile or edit-user page.
* FEATURE: Added the ability to print invoices/orders from the Memberships -> Orders page in the dashboard. (Thanks, AgResources)
* FEATURE: Added the ability to email invoices/orders from the Memberships -> Orders page in the dashboard. (Thanks, AgResources)
* ENHANCEMENT: Added pmpro_before_change_membership_level action. Runs before the subscriptions are cancelled and before the SQL executes to change a user's level. Passes $level_id and $user_id.
* ENHANCEMENT: Updated Stripe Web Hook handler to save event into global $pmpro_stripe_event so filters can act on it.
* ENHANCEMENT: Added $pmpro_level as a second parameter for the pmpro_setup_new_user filter. (Thanks, David Crabill)
* ENHANCEMENT: Added Vietnamese language pack. (Thanks, Alex Training Center)

= 1.8.5.6 =
* ENHANCEMENT: Added pmpro_payflow_authorize_nvpstr, pmpro_payflow_void_nvpstr, pmpro_payflow_charge_nvpstr, pmpro_payflow_subscribe_nvpstr, pmpro_payflow_update_nvpstr, pmpro_payflow_cancel_nvpstr filters for PayPal Payflow Pro gateway. Usage is the same as PayPal Express NVP string filters.
* ENHANCEMENT: Added printable and emailable invoice templates to the Orders page.
* BUG: Fixed $pmpro_core_pages bug added in 1.8.5.5.
* BUG: Removed styling of .input from frontend.css. (Thanks, Russell Jamieson)
* BUG: Commented out a console.log call from Stripe JavaScript code. (Still there to uncomment if you want to debug.)
* ENHANCEMENT: No longer requiring the CVC/CVV code with Stripe. If blank, Stripe will try to verify without it. If your Stripe settings are to decline transactions that fail CVC check, you will still need a valid CVC code at checkout.

= 1.8.5.5 =
* BUG: Added a $pmpro_core_pages global and using that in includes/init.php so we don't try to load preheaders and templates for pages added to that from other addons/etc.

= 1.8.5.4 =
* ENHANCEMENT: Added pmpro_get_membership_level_for_user and pmpro_get_membership_levels_for_user filters to change the levels returned for a user with the pmpro_getMembershipLevelForUser() and pmpro_getMembershipLevelsForUser() functions.
* ENHANCEMENT: Updated pmpro_hasMembershipLevels() function to search for expired members with "e" or "E". Also applies to [membership] shortcodes.
* ENHANCEMENT: Added the pmpro_extra_page_settings filter to add additional page settings fields for use with add-on plugins, etc.
* BUG: Fixed infinite redirect issues that would come up on servers setting $_SERVER['HTTPS'] to 'Off' vs 'off' or false. (Thanks, Gordon Seirup)
* BUG: Using current_time('timestamp') in the sales report to avoid issues where sales at the beginning or end of the day aren't showing up under Today.
* BUG: Fixed issues where delete links using the askfirst() JavaScript function would break for some language settings.
* BUG: Added "CVV" and "What's This?" from the checkout page to the .pot file. (Thanks, Laurentc)
* BUG: Fixed issue where preheaders/account.php was not loaded on the account page if you passed it sections params. (Thanks, sweettea)
* BUG: Fixed issue where no data was showing up for the 31st of the month on the graph of the signups/cancellations report. (Thanks, David Koller)
* ENHANCEMENT: Added the pmpro_extra_page_settings filter to add additional page settings fields for use with add-on plugins, etc.
* ENHANCEMENT: Added the pmpro_next_payment filter to PayPal Express and Stripe gateways. These use the respective APIs to get the next payment date instead of estimating it from the date of the last order. These filters are in place, but haven't been enabled because hitting the API on each call could cause performance issues when exporting members or something else.
* ENHANCEMENT: Now showing which levels a category is locked down for on the edit category page.
* ENHANCEMENT: Updated the PayPal IPN handler to check the initial_payment_status and set order to "error" status if the payment failed. This will keep PMPro from counting the order in sales totals and can be used by gists and addons to tweak how orders are dealt with.
* ENHANCEMENT: Filtering post_classes to add pmpro-level-required, pmpro-level-#, pmpro-has-access classes to post elements that require membership and/or the user has access to.

= 1.8.5.3 =
* BUG: Fixed issue where addon information was not being updated. (Thanks, walcee, jeff1010ihs, and ron)
* BUG: Fixed DB errors that would happen sometimes on brand new activations.
* BUG: Fixed notices in the code that shows a member's payment amount on the edit user/profile page.
* BUG: Fixed warnings that would show up if you used pmpro_getLevel('name') to get a level by name for a level that didn't exist.

= 1.8.5.2 =
* BUG: Fixed notice in pmpro_reset_update_plugins_cache
* BUG: Removed debug code from the PayPal Express gateway.

= 1.8.5.1 =
* ENHANCEMENT: Added the pmpro_get_addons_timeout and pmpro_license_check_key_timeout filters to change the default timeout during addon and license key checks.
* BUG: Fixed error handling during addon and license key checks.

= 1.8.5 =
* BUG: Fixed bug where the subscription_transaction_id was not showing up in the orders CSV export.
* BUG: Fixed bug where gateway subscriptions were not being cancelled when the "cancel at gateway" option was checked when changing a user's level on the edit user page.
* BUG: Drag and drop for reordering levels has been disabled if there are < 2 levels or if the user is searching the levels list. (Thanks, Isaac Coleman.)
* BUG: Fixed bug where sales and revenue charts would never show data for the 31st of the month. (Thanks, TYTNetwork)
* ENHANCEMENT: Now showing the time in date column of on the orders page and in the timestamp column of the orders CSV export.
* ENHANCEMENT: Added the pmpro_next_payment filter so you can alter how the next payment date is found. Also added a filter to the PayPal Express gateway class, but left it disabled for performance reasons.
* ENHANCEMENT: Now zeroing out the initial payment and billing amount in pmpro_memberships_users when an order gets cancelled.
* ENHANCEMENT: Modified how billing information shows up on the edit user page.
* ENHANCEMENT: Added partial Finnish translations. (Thanks, Onni Hakala)
* FEATURE: Overhauled the Add Ons page with one click installs and automatic updates of non-WordPress.org add ons for PMPro Plus members.

= 1.8.4.5 =
* BUG: Fixed broken links when adminpages/admin_header.php is loaded outside of the PMPro settings tabs.
* BUG: Fixed issue with PMPro page templates being loaded from child themes. (Thanks, SeventhQueen)
* BUG: Fixed bug where gateway subscriptions would sometimes be cancelled even if an admin unchecked the "cancel at gateway" option when changing a user's level on the edit user page. (Thanks, Scott Noelle)
* ENHANCEMENT: Added debugging to the Braintree webhook. Use define('PMPRO_BRAINTREE_WEBHOOK_DEBUG', true); in your wp-config.php to have debug emails sent to the admin when the Braintree webhook is hit.
* ENHANCEMENT: Updated email fields on checkout and billing update form to use the "email" field type instead of "text". If you need to revert this back to "text" type, use the pmpro_email_field_type filter like this: apply_filters('pmpro_email_field_type', '__return_false'); (Thanks, Yann Kozon)
* ENHANCEMENT: French translation updated and now includes email templates. (Thanks, Jean-Christophe Michel)
* ENHANCEMENT: Added the pmpro_is_ready filter. This should be used by gateway plugins to set the $pmpro_gateway_ready global variable.
* ENHANCEMENT: Added pmpro_memberslist_per_page and pmpro_orders_per_page filters to change the default number of items to show on those admin pages.
* ENHANCEMENT: Added pmpro_new_user and pmpro_new_user_setup hooks to allow for alterring the user creation code at checkout. For an example of how to use these see (https://github.com/strangerstudios/paid-memberships-pro/pull/224). (Thanks, David Crabill)
* ENHANCEMENT: Now setting the Stripe API version in the Stripe class. (Set to version "2015-07-13" right now.) This ensures that Stripe processes PMPro API calls correctly. We will update this to the latest versions as they come out and we test PMPro against them. You will still need to update the API version in the Account Settings of your Stripe dashboard to versio 2015-07-13 (or later as we update the version we work against) so webhook events originating from Stripe are sent out in the correct format.

= 1.8.4.4 =
* BUG: Fixed issue where subscriptions cancelled at Stripe wouldn't cancel the related PMPro membership if the membership was created after updating to v1.8. (Thank, Ninjami-Juho)
* BUG: Now tracking "views" when the wp_head hook is fired instead of the "wp" hook. Previously page redirects and AJAX calls might have been counted as "views". Using wp_head will result in more accurate numbers (compared to something like Google Analytics, e.g.). Also note that the number of views will now be much much lower than before on some sites. (Thanks, Michael Cummings)
* BUG: Fixed loading of email templates from language folders in themes, child themes, and languages folder. (Thanks, Karel Martens)
* ENHANCEMENT: Added the pmpro_format_phone filter to change how phone numbers are formated. Param 1 is $r, the formatted phone number. Param 2 is $phone, the original phone number.
* ENHANCEMENT: Added doc blocks to cleanPhone and formatPhone functions and the new pmpro_format_phone filter.

= 1.8.4.3 =
* SECURITY PATCH: Fixes to Cross Site Scripting vulnerabilities in the PMPro settings pages in the WordPress dashboard. [Advisory ID HTB23264](https://www.htbridge.com/advisory/HTB23264). (Thanks, High-Tech Bridge Security Research Lab)

= 1.8.4.2 =
* BUG: Fixed bug where dropdown to set the account page in the page settings was showing up twice.
* BUG: Fixed warning in pmpro_account shortcode.
* BUG: Grammar fixes in admin pages. "Setup" changed to "Set Up" when used as a verb. (Thanks, sumobi on GitHub)
* ENHANCEMENT: If the option is set, terms of service page embedded on the checkout page will not be passed through do_shortcode so shortcodes get processed in the text. (Thanks, cliffordp on GitHub)
* ENHANCEMENT: The pmpro_account shortcode will now accept "membership" or "memberships" for the section name.

= 1.8.4.1 =
* BUG: Fixed issue introduced in 1.8.4 where levels wouldn't show up in the front end if they hadn't been reordered.

= 1.8.4 =
* BUG: Fixed the Stripe webhook to work on new orders that are storing the subscription id instead of the customer id in the subscription_transaction_id field. (Thanks, nickd32 on GitHub)
* BUG: Fixed issue where the name and email address of customers was not being sent to Stripe if existing members checked out while the "show billing address" option was set to false.
* BUG: Fixed bug where users who checked out with the Braintree Payments gateway could checkout again using their on file credit card if an invalid credit card was entered at checkout the second time. (Thanks, patternsinthecloud)
* BUG: Updated the 2Checkout PHP API library and fixed some issues with 2Checkout integration.
* BUG: Fixed issue where custom roles had to have pmpro_membershiplevels capability to view other PMPro-related dashboard pages. (Thanks, squarelines)
* ENHANCEMENT: Added the ability to order levels on the Levels page by drag and drop in the WordPress admin.
* ENHANCEMENT: Now hiding tabs in the PMPro settings if a user doesn't have access to that tab (but does have access to other tabs).
* ENHANCEMENT: Converted all files to unix format and removed trailing whitespace. This has no functional change on the plugin, but helps developers who are contributing. (Thanks, meths on GitHub)
* ENHANCEMENT: New Danish translation. (Thanks, Morten Stenbæk and Frederik Hermund)

= 1.8.3.1 =
* BUG: Changed some uses of $wpdb->base_prefix to $wpdb->prefix to fix multisite support.
* BUG: Wrapped pmpro_isDateThisMonth in a function_exists check since some addons already have this defined.

= 1.8.3 =
* SECURITY PATCH: The pmpro_getOption function has been updated to not set values from $_REQUEST when available. This allowed malicious users to override PMPro settings on single page loads allowing them to inject text into pages and do other "bad things". (Thanks, Charles Hill)
* SECURITY PATCH: Many calls to pmpro_getOption("gateway") were changed to use pmpro_getGateway which specifically allowed for overriding that one value via a request parameter (the validity of the gateway is double checked).
* BUG: No longer showing the number of visits/views/logins "this month" when the user hasn't visited in over a month. (Thanks, Kenneth)
* BUG: Fix for email from names with apostrophes and quotes in them.
* BUG: Using current_time() and escaping form values better in logins report.
* BUG: Fixed issue in pmpro_generateUsername() when checking for duplicates. (Thanks, Ruslan)
* BUG: Fixed issue where $user var wasn't set for emails sent out in the Braintree webhook script. (Thanks, Charles Hill)
* ENHANCEMENT: Added pmpro_account_bullets_top and pmpro_account_bullets_bottom hooks to add content to the accounts page.
* ENHANCEMENT: Added pmpro_get_recurring_payments_profile_details_nvpstr, pmpro_manage_recurring_payments_profile_status_nvpstr, pmpro_create_recurring_payments_profile_nvpstr, pmpro_do_express_checkout_payment_nvpstr, and pmpro_get_express_checkout_details_nvpstr hooks to filter specific nvp strings in the PayPal Express integration.
* ENHANCEMENT: Added labels to checkboxes in the dashboard settings pages.
* ENHANCEMENT: Can now use the [pmpro_account] shortcode on other pages/widgets/etc. Can also limit to specific sections [pmpro_account sections='membership,profile,invoices,links'] just remove sections from that list.
* ENHANCEMENT: Changed all uses of the global $table_prefix to use $wpdb->base_prefix to aid in compatibility when loading WordPress with other PHP code (e.g. phpBB). (Thanks, Dion)
* ENHANCEMENT: The notification script was updated to point to notifications.paidmembershipspro.com instead of www.paidmembershipspro.com/notifications/. This allows us to keep our notification script on a different server. This script is used to insert notifications into the PMPro admin pages when important updates are available.

= 1.8.2.2 =
* BUG: Fixed conflicts when other plugins with older Recaptcha libraries are also activated. Prefixed our copy of the Recaptcha library and functions with pmpro_ and added code to handle cases where an older version of recaptch is used at checkout.
* BUG: Fixed warnings in pmpro_formatPrice. (Thanks, Andrea Carraro)

= 1.8.2.1 =
* BUG: Fixed issue where admins would get emails RE membership changes whenever a profile was updated even if the membership wasn't changed. (Thanks, chrisw123)

= 1.8.2 =
* BUG: Fixed issue where calls to pmpro_hasMembershipLevel() using level names wasn't working. (Thanks, Scott Slone)
* BUG: Fixed issue with memberslistcsv capabilities. (Thanks, Arnaud Devic)
* BUG: Fixed fatal error that could come up sometimes when PMPro could not find a subscription for a user in Stripe. (Thanks, Chris Eller)
* ENHANCEMENT: Triming whitespace off of search text on members list and orders list searches.
* ENHANCEMENT: Security hardening of SQL queries for members list, orders list, and some helper functions.

= 1.8.1 =
* BUG: Fixed typos in pmpro_memberslist_csv and pmpro_orderscsv capabilities. (Thanks, Arnaud Devic)
* BUG: Only loading the Braintree API when using it now.
* BUG: Fixed fatal error that would occur at checkout if PayPal Standard were used with a discount code. (Thanks, John Zeiger)
* BUG: Fixed issue where discount codes would not work if billing address fields were hidden. (e.g. paying by PayPal or check)
* BUG: Fixed issue with the logic around sending emails when admin's change a member's level or expiration date. Admins will always get an email. Members will only get an email if the checkbox is checked.
* ENHANCEMENT: No longer showing check instructions at checkout if the level is free.
* ENHANCEMENT: Added pmpro_stripe_create_subscription filter. (Thanks, nickd32 on GitHub)
* ENHANCEMENT: Added Czech (cs_CZ) language files and support for using decimals as separators. (Thanks, Martin "shr3k" Kokeš on GitHub)

= 1.8 =
* ENHANCEMENT: Payment gateway classes updated so all settings and checkout fields are processed via the gateway class file. This will make it easier to maintain, update, and add new gateways.
* ENHANCEMENT: Added a pmpro_after_membership_level_profile_fields hook after the "Membership Level" field dropdown on the edit profile page.
* ENHANCEMENT: Added new statuses for orders when cancelled. cancelled = cancelled by user on cancel page or via gateway, cancelled_admin = cancelled by an admin, expired = cancelled via expiration script, level_change = user upgraded/downgraded to a different level.
* ENHANCEMENT: All gateways use the $pmpro_currency global instead of getting the value via pmpro_getOption.
* ENHANCEMENT: Changing South African Rand (ZAR) to use the symbol R to the left of prices. (Thanks, Rasada)
* BUG: Fixed some translation issues on the checkout page and in level cost text. (Thanks, Jenkisan)
* ENHANCEMENT: Added plural forms of Day, Week, Month, Year to es_ES translation. Other translation files will need to as well.
* BUG: Fixed bug where the $short parameter of pmpro_getLevelCost wasn't shortening the output in some cases. (Thanks, Kimberly Coleman)
* BUG: Fixed warning in membership dropdown on edit user/profile page. (Thanks, Thomas Sjolshagen)
* ENHANCEMENT: Added German (de_DE) translation files. (Thanks, Cedros)
* ENHANCEMENT: Added Dutch (nl_NL) translation files. (Thanks, Het Verzamelteam)
* ENHANCEMENT: Added settings links to plugins page.
* BUG: Fixed bug in Safari for iOS where checkout submission would fail after choosing "Not Now" when prompted to save the card.
* ENHANCEMENT: Added user row actions to the members list and orders list in the dashboard. Add actions using the pmpro_memberslist_user_row_actions and pmpro_orders_user_row_actions filters which work the same as the core WP user_row_actions filter.
* BUG: Fixed issues with the membership shortcode and pmpro_hasMembershipLevel function.
* ENHANCEMENT: Can now use L or -L to check if a user is logged in (L) or not (-L) in the membership shortcode or pmpro_hasMembershipLevel function.
* ENHANCEMENT: Updated to the new version of Google's ReCaptcha.
* BUG: Fixed issue with quotes and other special characters in membership level names, descriptions, and confirmations. (Thanks, Marcelo Hinojosa)

= 1.7.15.3 =
* BUG: Now correctly setting $saveid when a discount code is created so the pmpro_save_discount_code hook will have the correct id value when codes are created.
* BUG: Using get_userdata in checkout code for better multisite support when setting default role of new users.

= 1.7.15.2 =
* BUG: Stripe JS looks for a field with id AND name = CardType now so the new checkout code is compatible with older checkout templates and will avoid "complete all fields" errors.
* BUG: Removed the urlencode wrappers on the Payflow API calls. Payflow seems to expect the values to be NOT encoded.
* BUG: No longer running email content through wpautop if there is already HTML in an included header or footer for the email. (Thanks, Erik Bertrand)

= 1.7.15.1 =
* BUG: Fixed issue where "complete all required fields" was being shown when using Stripe. They are calling the CardType "brand" in their return object, not "type".
* BUG: Removed code from includes/notifications.php that was deleting the transient used to keep PMPro installs from hitting the PMPro server too often.
* ENHANCEMENT: Added the "pmpro_checkout_signon_secure" filter so you can tell PMPro to login over http or https in case other plugins (like WordPress MU Domain Mapping) conflict with what should be chosen here.
* Avoiding some warnings.

= 1.7.15 =
* SECURITY FIX: The /services/getfile.php script has been disabled by default. You must set the PMPRO_GETFILE_ENABLED constant to true or 1 to allow the script to run. Additionally, the script will strip ../ and /. type strings out of the URI when looking for files to get and will not read any files using the extensions set via the pmpro_getfile_extension_blacklist filter. By default inc, php, php3, php4, php5, phps, and phtml file types are not allowed. (Thanks, Kacper Szurek)
* BUG: Fixed issue with Stripe integration where existing members checking out for new recurring subscriptions would receive extra charges. Now deleting the old Stripe subscription and any related open invoices and creating a new subscription instead of just updating the old subscription. (Thanks, Antonv and Thomas Sjolshagen)
* BUG: Fixed issue with Braintree integration where the billing address associated with a credit card was not being updated via the update billing page. (Thanks, Keith Abramo)
* BUG: Fixed issue where pmpro_next_payment() would return a 0 timestamp instead of false when there is no previous order. (Thanks, Thomas Sjolshagen)
* ENHANCEMENT: Added pmpro_formatPrice() and pmpro_getCurrencyPosition() functions. Now using them to render prices with formatting. You can use the pmpro_format_price filter or pmpro_currecies filter to adjust the formatting of prices to support currency symbols after the price or to use commas instead of periods for separators.
* ENAHNCEMENT: Added getSubscriptionStatus() to Authorize.net gateway class. Also fixed up some of the logic around checking the gateway environment.
* BUG: Now urlencoding the API Username and Password sent through the PayPal APIs in case your values have + or other special characters in them. (Thanks, mrschmiddy)
* BUG: Now showing cycle number in the Fee column of the members list. E.g. a level that is $10 every 3 months will now show up as $10.00 + $10.00/3 Months.
* BUG: Fixed bug where user first_name and last_name were being overwritten by PayPal values when using PayPal Standard.
* ENHANCEMENT: Added PMPRO_CRON_LIMIT constant, which can be used to limit the number of records processed by each scheduled cron job. This can for example, keep your server from going over PHP time limits or email limits. Use define('PMPRO_CRON_LIMIT', 100); to set the limit to 100.
* BUG: Discount code AJAX calls now going through admin-ajax.php, fixing issues where the Themed Profiles module of Theme My Login would block those calls. (Thanks, Tony)
* ENHANCEMENT: Removed the "CardType" field at checkout and now using the jquery.creditCardValidator script to determine the card type on form submit.
* BUG: No longer setting $order->subtotal and invoice total to the billing amount (vs the initial price) for recurring payments with Cybersource, PayPal Standard, PayPal Express or Twocheckout. (Thanks, Joce Nunes)
* ENHANCEMENT: The search filter will no longer filter out a post that is in a category blocked by one membership level if the user also has access to that content through another category.
* BUG/ENHANCEMENT: Running email body through wpautop if it doesn't look like HTML.
* ENHANCEMENT: Added pmpro_getfile_before_error hook in getfile.php.
* ENHANCEMENT: Added pmpro_ipn_check_receiver_email filter if you want to change how the email is checked in the IPN log.
* BUG: Fixed bug where reports would show duplicate month labels on the last day of the month.
* BUG: Fixed some issues with logging in at checkout, especially when using FORCE_SSL_ADMIN. (Thanks, Wimans)
* ENHANCEMENT: Added "pending" as a default status for orders available on the edit order page in the dashboard.

= 1.7.14.2 =
* BUG: Removed the debug call to d($...) that was left in preheaders/checkout.php and would show up when checkout forms were submitted with empty fields. (Thanks, Nicolas)

= 1.7.14.1 =
* BUG: Fixed warnings in PayPal Express class that could break redirects at checkout. (Thanks, Adam Warner)
* BUG: Fixed issue where new users who checked out with Braintree weren't having their customerid's saved, which led to subscription syncronization issues if they checked out again or updated their billing.
* BUG: Fixed warnings in the membership-billing page.
* BUG: Fixed false positive "There are JavaScript errors on the page. Please contact the webmaster." errors.
* BUG: Fixed issue where users on some sites running 1.7.14 could not logout.
* OTHER: Changed the CSS class of the checkout button generated via [checkout_button] shortcode or pmpro_getCheckoutButton() function from "btn btn-primary" to "pmpro_btn" to match other buttons generated with PMPro.

= 1.7.14 =
* BUG: Fixed bug where level cost would sometimes have incorrect pluralization of months/weeks/etc. (Thanks, Kevin Ackerman)
* BUG/ENHANCEMENT: Now checking the child and parent theme for email_header.html and email_footer.html files to use for emails. The child theme is checked first.
* ENHANCEMENT: Added pmpro_getfile_before_readfile hook (passes $filename and $mimetype params) in getfile.php
* BUG/ENHANCEMENT: getMembershipLevel method of MemberOrder can now handle when discount_code property is an object. Also, the IPN Handler and 2Checkout handler will now try to get the discount code for the order to correctly update the users pmpro_memberships_users entry.
* BUG: Removed extra class attribute from CVV field that interfered with the required * JS code and some other CSS/JS-related things. (Thanks, catapult)
* ENHANCEMENT: Added code to redirect to the redirect_url if you pass a redirect_url to the login page and the user is already logged in. Updated the links in email confirmations to use login links with redirects instead of direct links.
* EHANCEMENT: Added pmpro_email_attachments filter, which can be used to add attachments to PMPro emails that are sent out. E.g., https://gist.github.com/strangerstudios/c4e771dca8723613bce3

= 1.7.13.1 =
* Fixed bug introduced in 1.7.12 where discount code uses were not being tracked.
* Added pmpro_check_discount_code filter so you can do your own checks on discount codes.

= 1.7.13 =
* Added Danish (da_DK) translation. (Thanks, Mikael)
* Fixed bugs with timestamps in various places (especially around trial dates) introduced in 1.7.12
* Another fix to keep PMPro from sending "undefined undefined" as the name to Stripe when the 'don't show billing fields' option is chosen.
* $pmpro_stripe_verify_address flag defaults to same value of Stripe's showbillingaddress option now.
* Changed the priority of pmpro_applydiscountcode_init hooking on init to 11 so pmpro_init() will run before and setup pmpro_currency_symbol among other things. (Thanks, semyou on GitHub.)
* Explicitly setting $current_user->membership_level in a few places to avoid issues where current_user is overwritten between init and when we try to use it.
* Avoiding a warning in pmpro_getMetavalues() function. (Thanks, Scott Sousa)
* Added target="_blank" to help links on admin pages. (Thanks, AntonVrba on GitHub)

= 1.7.12 =
* Now including expiration text in text that is updated when a discount code is used. (Thanks, John Zeiger)
* Fixed check for subscription_transaction_id in readonly fields array.
* Making sure that $myuser->membership_level is set in pmpro_has_membership_access().
* Added Norwegian locale files. (Thanks, Maritk)
* Added Turkish locale files. (Thanks, yasinkuyu on GitHub.)
* Fixed error where "undefined" was being passed to Stripe for the name.
* Fixed error with setting enddates on the edit user page for users with multiple "active" memberships.
* "Renew" link will show up on levels page only if the user has the level and it is not recurring and has an enddate.
* Stripe gateway is using $pmpro_currency global instead of getting value via pmpro_getOption, so it can be overridden via code like https://gist.github.com/strangerstudios/8806443
* Payflow Pro gateway is now passing the currency code to the API for non-US currencies. (Thanks

= 1.7.11 =
* Added "Filter searches and archives?" setting to advanced settings tab. If you had "Show excerpts to non-members?" set to No before, then this will be set to Yes after upgrade. But now you can show excerpts on single post pages while still hiding restricted content from searches and archives.

= 1.7.10.2 =
* Fixed MySQL warning/error that was introduced in 1.7.10.1 and showing for some people who had "hide excerpts" enabled.

= 1.7.10.1 =
* Fixed bug where the $pmpro_levels global would sometimes not include all levels on the levels page. (A better fix for this is coming in v2.0.)
* Fixed bug in pmpro_getMemberDays that sometimes reported more days than the user had really been a member. (Thanks, surefireweb)
* Fixed bug where search results were being incorrectly filtered. The pmpro_search_filter() function in includes/content.php hides member content from non-members if the "show exceprts" setting is set to false.
* Now checking specifically for payment_status = 'Failed' in the IPN handler before sending off the payment failed emails. (There may be other statuses we want to consider as "failures" as well, but we want to avoid failing on "pending" statuses/etc.)

= 1.7.10 =
* Added getGatewaySubscriptionStatus() and getGatewayTransactionStatus() methods to the MemberOrder class. These are implemented for PayPalExpress right now and will hit the gateway API to return information on a subscription or transaction.
* Added pmpro_memberslist_expires_column filter to members list. $order is passed as second parameter. Use this to filter the date or "Never" shown in the Expires column.
* No longer showing "Membership Levels" link in dashboard menu if a user has access to other PMPro settings pages, but not the membership levels page.
* Added pmpro_applydiscountcode_return_js hook. http://www.paidmembershipspro.com/hook/pmpro_applydiscountcode_return_js/
* Fixed formatting of the level cost when a discount code is applied via AJAX.
* Removed extra $ in checkout_check.html email template.
* Fixed bug where pmpro_setOption was not working for array values in $_POST, e.g. the hideadlevels setting on the Advanced Settings page.
* pmpro_getMembershipCategories($level_id) now returns an array of category IDs instead of an array of arrays.
* Swapped all _x function calls to use __ or _e so they are translated.
* Initial Czech Republic (cs_CZ) translation files. (Thanks, Petr Hlaváček)

= 1.7.9.1 =
* Firing activation hook on upgrade so menu doesn't disappear.

= 1.7.9 =
* Updated PayPal Express/Standard/WPP gateways to throw an error when trying to cancel a subscription that is in pending or suspended status. A warning is shown to the user to contact the site owner or cancel the subscription through PayPal. The WP admin should also get an email about the failure. In the future, there may be a better way to handle these situations automatically, but PayPal doesn't advise how to "cancel" pending subscriptions.
* Added optional $membership_id parameter to getLastMemberOrder() method of the MemberOrder class. So you can get the last member order of a specific level.
* Added Slovakian translation. (Thanks, Peter Belko)
* Added WP capabilities for each PMPro settings or report page. Admins are given these caps on plugin activation. Or you can set up other roles to use these caps. E.g. https://github.com/strangerstudios/pmpro-membership-manager-role/

= 1.7.8.2 =
* Updated the Stripe API library to version 1.11.0.
* Fixed issues where users upgrading or downgrading would have their subscriptions cancelled at Stripe.
* Fixed issues where extra emails were being sent out when users cancelled a membership when using Stripe.
* Generally made the Stripe integration better and ready for version 2.0.
* The Stripe webhook will now add a 5 second delay before processing most requests. This is to ensure that PMPro has time to update the order during checkout (Stripe can sometimes receive a charge or cancellation, then send the webhook, and WP can process that in the split second it takes PMPro to save an order during checkout.). This prevents duplicate orders in the PMPro DB on some charges and fixes some issues with cancellations.
* Setting constant PMPRO_STRIPE_WEBHOOK_DEBUG to true will send an email to the WP admin every time the Stripe Webhook is hit. You can also set it to an alternative email address or "log" to have it added to ../paid-memberships-pro/logs/stripe-webhook.txt.
* Setting constant PMPRO_IPN_DEBUG to true will send an email to the WP admin every time the IPN handler is hit. You can also set it to an alternative email address or "log" to have it added to ../paid-memberships-pro/logs/ipn.txt.
* Now showing the PMPro order ID/code in INVOICE emails instead of the Stripe order id when using the Stripe gateway.

= 1.7.8.1 =
* Important fix for Braintree Payments users. Credit card information is now correctly updated in Braintree when users submit the form on the billing information page or checkout again on the site. (Thanks, Bryan Paronto and venrooy)
* Updated Italian translation files. (Thanks, Angelo Giammarresi)
* Fixed string wrapping in reports for translation.
* Fixed PHP warning in membership stats report.

= 1.7.8 =
* Added various hooks.
* Updated the expiration field dropdown on the edit levels page to use translation strings. (Thanks, 24uurdates)
* Fixed other missing strings for translation. Added Right-to-Left support. (Thanks, louy on GitHub.)
* Added the pmpro_member_startdate filter to filter the pmpro_getMemberStartdate function. Passes $user_id, and $level_id as parameters.
* Added pmpro.getMembershipLevelForUser and pmpro.hasMembershipAccess XMLRPC methods. Example usage: https://gist.github.com/strangerstudios/9099164
* Moved the Terms of Service page/etc to right above the checkout button.
* Now caching the pmpro_getAllLevels() function.
* Added HTML <!-- comment --> wrappers to the JS on checkout.php. Helps with validation and potentially really old browsers.
* Fixed warnings in includes/login.php.
* Added pmpro_delete_discount_code and pmpro_delete_membership_level actions which run just BEFORE a membership level is deleted. Both pass the discount code ID or level ID respectively.
* Added a third "short" parameter to the pmpro_getLevelCost() function. If set to true the "The price for membership is" text is left off the beginning. The new levels page uses this param.
* Updated the table on the levels page to have one "Price" column showing the cost and expiration text. The text is generated using pmpro_getLevelCost and pmpro_getLevelExpiration instead of its own rules.
* Updated level cost text to say $1/mo instead of $1 now and then $1/mo, etc. (Thanks, louy on GitHub.)
* Added a debug by email method for the Authorize.net Silent Post handler. Add define('PMPRO_AUTHNET_SILENT_POST_DEBUG', true); to your wp-config.php. We will probably move the other services to debug by email as well.
* PMPro will now only filter the from name and email if the default values are detected (WordPress <wordpress@sitename.com>). This fixes issues where the from name and email on form emails or other plugin emails were being swapped out with the PMPro settings, which was not always desirable. (Thanks, Helen Hou-Sandi and others.)
* Added an "Only Filter PMPro Emails?" option to the email settings. If checked, only emails sent through the PMProEmail class will have their from name and email adjusted to match the PMPro email settings.
* Added filter options to orders page in admin and export. (Thanks, HTCIA and Harsha Venkatesh)
* Added Brazilian Portuguese translation. (Thanks, dballona on GitHub.)
* Fixed some warnings. (Thanks, AlexBiddle on GitHub.)
* Added pmpro_custom_advanced_settings hook to add settings to advanced settings page. Details on usage here: https://github.com/strangerstudios/paid-memberships-pro/pull/86 (Thanks, Jess Oros)
* Updated addon categorization to reflect a lot of addons which have moved into the WordPress.org repository as well as updated versions.

= 1.7.7 =
* Fixed bug where user_id = '' was breaking on some MySQL setups and keeping the pmpro_membership_orders table from being populated.
* Updated "Joined" column in members list to use the WP date format setting.
* Removed redundant phone number on checkout page if bphone is already set.
* When adding extra columns to the Members List CSV export via pmpro_members_list_csv_extra_columns, we are now passing the original heading/field name to callback function. So you can use that in your callback functions. This generally means you can use one function that just dumps the meta value rather than requiring a separate function for each meta value.
* Fixed bug where "Show Billing Fields" option was visible on the payment settings page for the testing gateway. (This option is only for Stripe.)
* Fixed bug with choosing levels to hide ads from on advanced settings tab. (Thanks, Alain Fradette)
* Fixed bug where PayPal Express was adding tax twice for subscription charges. (This does not fix existing subscriptions on the PayPal side.)
* Fixed bug with the Stripe Webhook where non-PMPro orders were being added to PMPro via the webhook. If the customer_id cannot be found (i.e. it's a non-PMPro customer), the order is ignored. (Thanks, Jacob Glenn)
* The getMemberOrderByPaymentTransactionID() function has been updated to return false if no payment_transaction_id is passed in (instead of finding the first order where the id is blank). This is inline with the getMemberOrderBySubscriptionTransactionID() function.
* Fix to code that hides posts from search to NOT hide posts that a user has access to but might also be accessible by users of a different level. (Thanks, normanyung on GitHub)
* Added a pmpro-en_GB translation that changes "State" to "County" on the billing address fields. (Thanks, alexbiddle on GitHub)

= 1.7.6 =
* Added "Old Members" option to the members list page to view members who don't have an active membership, but did in the past. (Note that we don't differentiate between members who expired and who cancelled.)
* The PayPal IPN Handler has been updated to process "subscr_cancel" messages from PayPal. This should cancel memberships in WP/PMPro when users or PayPal admins cancel a subscription at PayPal when using PayPal Express or Website Payments Pro. There are still known issues with syncing cancellations with PayPal Standard.
* Fixed bug where "error cancelling subscription" emails were being sent out erroneously. These should only go out now if PMPro has trouble cancelling a subscription. If you got a lot of these before, you should get less. If you never got this, you might start getting it sometimes.
* Orders are now set to "cancelled" status whether any attached subscriptions were cancelled or not. (Keeps us from trying again.)
* Fixed bug where All Pages view in WP dashboard would sometimes redirect to the registration page if you had Theme My Login installed.
* Setting startdate to NOW() when a user's level is changed via pmpro_changeMembershipLevel() using a level ID... also when admin's manually change a user's level. This fixes issues with PMPro Series where users who were given a level this way appear to have a start date in 1970, etc.
* Fixed bug with the pmpro_save_discount_code_level filter where -1 was being passed as the code_id for brand new codes.
* Updated "The ____ code has been applied to your order" message to it is wrapped for localization.
* Now checking ICL_LANGUAGE_CODE instead of $_REQUEST['lang'] to support WPML using different language URL formats.
* Unsetting $all_membership_levels[$user_id] at the bottom of pmpro_changeMembershipLevel().
* Added $force parameter to pmpro_getMembershipLevelForUser($user_id, $force). If set to true, it will ignore the cached value and pull the level from the DB.
* Added autocomplete="off" to credit card account number field on checkout and update billing pages.
* Added an optional $seed parameter to pmpro_getDiscountCode() which will add $seed to the scrambled string. Useful when generating many discount codes quickly and time() might not have changed.
* Now hiding "Change Membership Level" link from Member Links section of Membership Account page if PMPRO_DEFAULT_LEVEL is defined.
* Clearing the AccountNumber value at checkout if it is XXXX..., e.g. when we mask the Stripe CC number. This way users will know they need to re-enter the credit card again. (Thanks, Gary)
* Fixed bug on checkout page where html classes for the bstate field were being set based on the bcity value instead.
* Fixed bug where there was no space after the "." in some level cost text. (Thanks, multiple observers ;)
* Added some explanatory text to the payment settings page about taxes and SSL seals.
* Added a pmpro_formatAddress() function to format billing addresses/etc.
* Fixed bug where blank billing addresses were showing up in confirmation emails. If you use custom email templates, update them to use the !!billing_address!! variable instead of the full address section.
* Design updates to checkout buttons, admin screens, etc, to work better with WP 3.8 and the TwentyFourteen theme.

= 1.7.5 =
* Fixed all open bugs with 2Checkout gateway. You can now use this gateway for one time and recurring levels. We're still keeping the beta message though until we have further live testing.
* The shortcodes for the PMPro pages (e.g. pmpro_levels/etc) will now work on multiple pages. Things may still act funny if you put the shortcodes on pages other than those set in the page settings, but you can do so if you know what you are doing. One limitation still in place is that you can only have one PMPro page shortcode per page. Whichever comes first will be used.
* Added support for WPML. Simply make a copy of each PMPro page for each language. Set the PMPro page settings to the default language pages.
* Updated pmpro.pot template along with a script gettext.sh that will allow us to easily update the pmpro.pot file when we need to.
* Updated the pmpro_url function, should work the same but if you use addons or customizations and notice bugs around URLs, let me know.
* Fixed bug where old membership data was being included in the members list export instead of the latest active membership data.
* Filtering $morder->membership_level at checkout as well as $pmpro_level global.
* When loading bemail and bconfirm email from user meta for existing users, just setting them both to $bemail so different emails don't show up.
* Now sending a member's email address to Stripe when customers are created/updated.
* No longer running wpautop on email via pmpro_send_email filter.
* If first_name and/or last_name are passed at checkout, these are used to create a new user instead of bfirstname and blastname.
* Added "view" links to the page settings page.
* Fixed some potential warnings in adminpages/reports/login.php.

= 1.7.4 =
* Updated PayPal IPN to use HTTP 1.1 and "Connection: Close" per recent PayPal IPN updates.
* Fixed bug with slashes being added to the SSL Seal text when Payment Settings are saved.
* Now applying the pmpro_checkout_level filter when a membership level is loaded from an order during the review step with PayPal Express checkouts. This will fix many customizations that might have not worked with PayPal Express.
* Cleaned up PayPal Express API integration a bit. Fixes some bugs on sites with one-time payments and taxes calculated in.
* Change the use_ssl payment setting. You can choose "No" now for gateways that require SSL. Just make sure you set it to Yes when going live or use another method to force SSL on your checkout page. You can also set it to Yes (use JavaScript redirect) to fix some issues that come up with infinite redirects on shared hosting with specific caching/proxy techniques.
* Optimized the members list and orders CSV exports to run with less memory. Especially important for large sites.
* Including Italian, French, Spanish/Peru, and Spanish/Chile language files contributed from the community. Thanks Mirco Babini (mirkolofio on GitHub) and Javier Monorové (zillionsk8 on GitHub)
* Fixed the email template issue for admin emails as well. The email sent to admins for free checkouts won't include the empty billing address info anymore. (Thanks, inator on GitHub)
* Now redirecting from /register/ to PMPro levels page when latest versions of Theme My Login are activated. Can still disable by returning false with the pmpro_register_redirect or pmpro_login_redirect filter.
* Now showing a "renew" button for the current user's level on the levels page if their level is not recurring.
* Fix in crons.php where in rare cases the pmpro_expiration_notice meta was not being set correctly for users, which might lead to multiple expiration warning emails.
* Updated pmpro_next_payment to work for any cycle number or period. (Thanks, antonv and others.)
* Now checking for a logged in user before trying to get a billing address to prepopulate at checkout.
* Updated frontend.css to make sure that background gifs in error messages aren't repeated or applied to dropdowns.
* Added some currencies: CNY, INR, IDR, KRW, TRY, VND, ZAR
* All currencies now available to all gateways. You still need to make sure that your gateway supports the chosen currency.
* Now sending all emails from the PMProEmail class from the pmpro_getOption("from_email") setting. Some were sent from the get_option("admin_email") setting before.

= 1.7.3.1 =
* Using MySQL to calculate months since first order instead of date_diff, which is only available in PHP 5.3+

= 1.7.3 =
* pmpro_longform_address and pmpro_international_addresses now default to true. See this gist to go back to US-specific address format: https://gist.github.com/strangerstudios/6478242
* Added "Show Billing Address Fields" option for the Stripe payment gateway. Set to 'No' to hide billing address fields. Replaces the functionality of the "Stripe Lite" plugin.
* Added language files for es_ES, es_CL, and es_PE. Thanks, Javier Monorové (zillionsk8 on GitHub).
* Added language files for fr_FR. Thanks, Jérémy De la casa.
* NOTE: Language files may not be complete. The get involved, join us on GitHub.
* Added Cybersource and 2Checkout gateways in beta.
* Added pmpro_paypal_button_image filter so you can override the URL of the PayPal button image.
* Added a new report showing signups vs. cancellations, monthly recurring revenue, and lifetime value.
* Fixed issue where the checkout_paid template was always being used for emails. It now checks if the level at checkout is free and sends either the checkout_free, checkout_paid, or checkout_trial templates accordingly. (Thanks, inator on GitHub)
* Fixed sales report to not show $ when hovering over bars for "sales" vs. "revenue".
* Fixed issue where PayPal Standard levels using a billing frequency > 1 (e.g. every 3 months) would have an extra payment charged after one period.
* Fixed SQL error in discount code admin page that could result in cycle_periods of code levels saving incorrectly. (Thanks, Sam D'Amico)
* Removed note that Payflow gateway doesn't support recurring payments. It does.
* Now passing the membership level id in the $data var for checkout and cancellation emails. The key is "membership_id" so use $data['membership_id'] to check/access it.
* No longer setting the subtotal property of orders when the "subscribe" method of the gateways is called. This will fix cases where an initial order or a subscription with a free trial showed a charge amount > $0.
* Clicking enter in discount code box at checkout will no longer submit form and will click the "apply" button.
* Hiding the "Apply" button on the checkout page if a discount code was passed in. Showing it if the text field is changed.
* Authorize.net now supports CAD, GBP, and EUR currencies (for US merchants only) http://community.developer.authorize.net/t5/The-Authorize-Net-Developer-Blog/Authorize-Net-Expansion-into-Canada-the-United-Kingdom-and/ba-p/33690
* Fixed notice in getfile.php
* Fixed notices and expiration dates in login report.
* Fixed notices in includes/notifications.php (Thanks, Nilesh)
* Allowing dashes (-) in discount codes now.

= 1.7.2.1 =
* Fixed warning when trying to load the "free" gateway on free level checkouts.
* Fixed warning coming from login report tracking.
* Changed all $wpdb->escape() calls to esc_sql() to fix notice.
* Fixed another bug in revenue/sales report for daily charts. (backported to 1.7.2, but a few people who upgraded missed it)
* Fixed bug on add/edit level page that was causing issues in some versions of IE.
* Fixed bug where links in the email_header.html and email_footer.html templates were not being converted to true links.
* Removed an extra $ from the PayPal Express confirmation emails.
* Fixed loading of local (in the paid-memberships-pro/languages directory) translation files. (Should have some bundled with the plugin soon.)

= 1.7.2 =
* Fixed the revenue/sales report to accurately track recurring sales and reports from earlier years.
* Now trimming whitespace on any text field updated through the PMPro settings pages. This prevents issues like those that come up if you have whitespace in your Stripe API key, etc.  Thanks, Scott Sousa.
* Added discount code use tracking for PayPal Standard. Saving the use before the user goes to PayPal to pay.
* Added discount code id and code columns to orders and members list CSV exports.
* Changed default capability check to 'manage_options' (administrator), and added a filter named 'pmpro_edit_member_capability' to allow dev's to change this capability. Thanks, Scott Sousa.
* Now removing empty (only includes the PMPro shortcode) PMPro pages when uninstalling PMPro. Thanks, Scott Sousa.
* Now adding classes to the body tag (if the theme supports it through the body_class() function) to aid in design. Classes are pmpro-account, pmpro-billing, pmpro-cancel, pmpro-checkout, pmpro-confirmation, pmpro-invoice.
* Adding $0 orders for free level checkouts (will help reporting).
* Added pmpro_invoice_bullets_top and pmpro_invoice_bullets_bottom hooks to confirmation and invoice pages. Passes $pmpro_invoice.
* Fixed members list CSV export for lists with search queries.
* Added is_ssl() check to pmpro_https_filter so PMPro will add HTTPS to URLs even if the $besecure global hasn't been set yet. Thanks, Andrew Calaio at wpcurve.com.
* Removed the pmpro_cron_trial_ending_warnings daily cron so trial ending emails will no longer go out. The function pmpro_cron_trial_ending_warnings() is still there if you want to call it yourself. There were issues on some sites where these emails were going out erroneously and also many ways of doing "custom trials" including setting the subscription start date back a certain number of days was not picked up as a trial by this script anyway.
* Added the pmpro_cron_credit_card_expiring daily cron to send out warnings a month or so before credit cards on record are set to expire.
* Updated pmpro_has_membership_access to return true if the $post_id is empty or cannot be found. This fixes issues where member warnings were being added to non-pages, e.g. the bbPress forums archive. To lock down "pages" like this, you'll need to use custom coding, URL detection, etc. Thanks, Scott Sousa (scottsousa on GitHub and WP.org) from Slocum Studio.

= 1.7.1 =
* Design updates to frontend and backend pages.
* Added Sales and Revenue Report.
* Fix to Braintree webhook that should help get it verified by Braintree more easily.
* Fix to PayPal IPNHandler to check both that either the primary or the business email address sent from PayPal matches the one stored in the payment settings.
* Added pmpro_ajax_timeout hook to change the timeout limit from 2000 (2 seconds) to something else.
* Fixed bug that occurred when the pmpro_register_redirect filter returned false or a blank link. Thanks, Vladimir Garagulya.
* Added pmpro_paypal_standard_nvpstr and pmpro_set_express_checkout_nvpstr filters to change or add parameters to an name-value-pair string sent to PayPal in a couple cases.
* Fixed checkout failure on Free level when in mySQL Strict Mode. (Thanks, inator on GitHub)
* Only checking pmpro_checkForUpgrades in admin/dashboard now. (Thanks, topdown on GitHub)
* No longer loading recaptcha library in the admin. Also wrapped the recaptchalib require in an init function to delay it a bit so we can check if other plugins have already loaded it.
* PMPro-Mailchimp and WP-Bouncer have been moved into the WP repository. Other Add-on updates.
* New users will now be set to the "default role" set in the General settings instead of spefically "subscriber". (Subscriber is the default default role though.) Thanks, Nabil Kadimi.
* Wrapped strings in login report for translation.
* Added indexes to the following columns in the pmpro_membership_orders table: status, payment_transaction_id, subscription_transaction_id, affiliate_id, affiliate_subid

= 1.7.0.4 =
* Another database fix for new installs.

= 1.7.0.3 =
* Fixed a performance issue added in 1.7.0.2.

= 1.7.0.2 =
* Fixed HUGE issue with the DB setup on fresh 1.7+ installs. If you installed version 1.7 or 1.7.0.1 fresh (not upgraded from earlier version) then PMPro will not work until you upgrade to version 1.7.0.2.
* Removed from old PHP short tag use
* Fixed generation of members only and non-logged in text on new installs.

= 1.7.0.1 =
* Added the redirect away from wp-login.php page (was accidentally removed in version 1.7).
* Added support for Theme My Login versions 6.3+
* Fixed CSV downloads.
* Fixed some warnings.
* Fixed generation of cost text when using built in tax.
* Added "pmpro_subscribe_order" filter.
* Added an index to the user_id column of pmpro_memberships_users table which will help with performance of the new logins report and other user search functions.

= 1.7 =
* Ready for localization efforts.
* Addons tab in PMPro Settings in the dashboard.
* Reports page in dashboard with login report.
* Webhook code for Braintree Payments gateway.
* If PayPal Standard is the active gateway, users without membership levels will be able to see the confirmation page with a message that PayPal is processing payment.
* Fixed bug where PayPal recurring orders were being attributed to the wrong user (if no subscriber id was attached to the IPN message).
* Fixed bug where users sometimes couldn't checkout with a discount code that made a level free.
* Cleaned up code in base paid-memberships-pro.php file.
* Updated the .pmpro_checkout tr.odd td line in frontend.css to use rgba with alpha transparency to work a bit better on dark background themes.
* Fixed bug where a user's first_name and last_name meta fields might be overwritten by the billing name fields at checkout. It will still set them if the user's first and last name fields are blank. (Thanks, John Hamlin.)
* Fixed bug where zipcode was shown instead of state in the members list CSV export. (Thanks, John Hamlin.)
* Fix to show discount codes on free trial confirmation emails if one was used.
* Added the pmpro_random_code filter so you can hook in and change invoice code/etc generation.
* Correctly padding zeroes on credit card expiration dates like 09/2013 when using Stripe. This SQL statement should fix broken entries in your orders table: NOTE (1) Backup your database first. NOTE (2) Make sure you change the table name to match your WP prefix,etc. >>> UPDATE wp_pmpro_membership_orders SET expirationyear = CONCAT(SUBSTRING(expirationmonth,2,1), expirationyear), expirationmonth= CONCAT('0', SUBSTRING(expirationmonth,1,1)) WHERE expirationmonth > 12;
* Wrapped some AJAX and service calls code in init() functions so they will more consistently work with hooks/filters. (Before if PMPro loaded before a plugin or bit of code that added filters/etc, the filters wouldn't get applied.)
* Fixed Stripe JS to also send city to Stripe. (This is important because Stripe doesn't seem to show the address at all if the city is missing.)
* Added 'pmpro_members_list_sql' hook to filter the SQL used on the members list page and CSV export.
* Added 'pmpro_members_list_csv_heading' and 'pmpro_members_list_csv_default_columns' hooks to filter the default columns in the members list CSV. (e.g. to check role and remove columns)
* Added 'pmpro_members_list_user_link' hook to filter the link and username displayed on the members list page. (e.g. to check role and remove link to edit user)
* Checking that "status='active'" when finding subscriptions to cancel when deleting a level. This will keep PMPro from trying to cancel someone more than once... or trying to cancel inactive subscriptions.
* Fixed bug where Sales Tax fields were hidden on the payment settings page if Stripe was chosen as the gateway.
* No longer logging IPN activity to logs/ipn.txt by default. (Uncomment the lines at the bottom of services/ipnhandler.php to use the log to debug.)

= 1.6.1 =
* Added recurring billing support to Payflow integration.
* Fixed bug where an order's code was shown instead of the subscription ID on the edit order page.
* Fixed some logic with determining if level settings are not compatible with the current gateway.
* On notice and one DB query fix in upgradecheck.php submitted by pranjithkumar on GitHub. Thanks!

= 1.6.0.1 =
* Fixed Braintree integration for production environments. Braintree needed to be told "production" instead of "live".
* Removed !!field!! lines from a couple of admin emails.
* Added login_link as data for the cancel_admin email template.

= 1.6 =
* Added Braintree payments as a gateway option. This should be considered in "beta". Please get in touch if you are using Braintree payments with PMPro. Everything should function except that we're still working out an issue with the webhook handler.
* Added a new dashboard page Orders to view all orders processed by PMPro with an option to export to CSV.
* Fixed bug where "Your membership level has changed" emails were being sent out the first time a user's profile was edited, even if the level wasn't changing.
* Removed the revenue estimate from the members list page. This causes performance issues on sites with many members. A new reports dashboard page is coming soon.
* Not showing payment settings warning now when Payflow is setup with all values filled in.
* Updated preheaders/billing.php to get the most recent successful order from the DB to use when updating. (ORDER BY id DESC in the query)
* Added pmpro_stripe_subscription_deleted hook in stripe-webhook.php for when subscriptions are cancelled on the Stripe side. Use this code to cancel on your site as well: https://gist.github.com/strangerstudios/5093710
* Now using $pmpro_currency_symbol when membership price is shown on the edit profile page in the dashboard/etc.
* Added pmpro_authorizenet_post_url filter to use Authorize.net gateway class with a different post url, e.g. if you have a gateway that offers an Authorize.net compatibility mode.
* Added pmpro_check_status_after_checkout filter so you can e.g. set the status to "pending" instead of "success" when a user checks out with the check gateway. They will still have access to the membership level, but you can update the status via the orders dashboard later.
* Added pmpro_confirmation_order_status filter so you change which status the confirmation page looks for. Can return an array as well since the getLastMemberOrder method call on MemberOrder has been updated to support $status as an array.
* Orders made via the check gateway now have PaymentType = "Check" and CardType = "".
* Added a notes column to orders.
* Fixed bug where discount codes were not showing up in checkout emails if the level was free.
* Added some wpdb->escape() wrappers to the saveOrder method of MemberOrder which will fix some bugs with orders with fields with apostrophe's in them, etc.
* Added checks for custom capabilities to the PMPro admin pages in case you want to give non-admins access. Caps are: pmpro_discountcodes, pmpro_emailsettings, pmpro_membershiplevels, pmpro_memberslist, pmpro_memberslist_csv, pmpro_orders, pmpro_orders_csv, pmpro_pagesettings, pmpro_paymentsettings
* Added pmpro_memberslist_extra_cols_header and pmpro_memberslist_extra_cols_body hooks to add extra columns to the members list page.
* Fixed pmpro_paypal_express_return_url_parameters filter to properly encode & and = so the params are properly added to the ReturnURL instead of being seen as extra params to the full PayPal Express URL. The PMPro Addon Packages plugin has been updated to take advantage of this to make that plugin more compatible with PayPal Express.
* Fixed bugs with Strip webook: now listening for charge.succeeded and charge.failed, other fixes.

= 1.5.9.2 =
* Fixed Members List bugs introduced in version 1.5.9.1.

= 1.5.9.1 =
* Revamped the ipnhandler code. It's much cleaner now and should be easier to support with all 3 PayPal APIs (Standard, Website Payments Pro, Express) working through the one handler.
* Added Payflow Pro as a gateway option. Currently, only one-time charges is supported.
* Added the pmpro_register_redirect filter to allow you to change the URL PMPro redirects wp-login.php?action=register to. Returning false or an empty string will result in no redirect from the register page.
* Added pmpro_subscription_payment_failed hook that runs if a failed payment comes in through the IPN Handler, Authorize.net silent post, or Stripe web hook. do_action("pmpro_subscription_payment_failed", $old_order); $old_order is a MemberOrder object.

= 1.5.9 =
* Fixed bug on Membership Billing page that was hiding the billing address fields.
* Changed all of the instances of "firstpayment" order statuses to "success". Also running query to fix statues in the DB. This caused issues for levels with only a one-time payment, where the invoice wouldn't show up in their account page.
* Fixed the PayPal Express gateway to correctly set the order transaction id to TRANSACTIONID instead of the PROFILEID.
* Updated the IPN handlers to accept recurring_payment_id or subscr_id when checking for recurring payment orders.
* Changed the site_url() in the javascript for discount codes on the checkout page to home_url(). home_url() is better to use in case users have their WP core files in a different directory.
* You can now place email templates in a paid-memberships-pro/email folder in your theme and PMPro will use these before using the built in email templates. Just copy the file out of the wp-plugins/paid-memberships-pro/email folder, use the same filenames, and edit the file.
* You can now place page templates in a paid-memberships-pro/pages folder in your theme and PMPro will use these before using the built in page templates. Just copy the file out of the wp-plugins/paid-memberships-pro/pages folder, use the same filename, and edit the file.
* You can now place css templates in a paid-memberships-pro/css folder in your theme and PMPro will use these before using the built in page templates. Just copy the file out of the wp-plugins/paid-memberships-pro/css folder, use the same filename, and edit the file.
* Fixed a bug where discount codes that reduced a level price to $0 were not being counted as "uses".
* Added a pmpro_email_data filter to make it easier to add variables to edited email templates.
* Added user_login to the data fields all of the emails for use by templates (use !!user_login!! in your template)
* Added $wp_version to globals set in preheaders/checkout.php to properly compare versions later in the script and avoid a notice.
* Added pmpro_email_filter hook to filter entire email object at once.
* Warning fix: Updated email class to check if the template file exists before trying to load the template into the body. (Useful if you are using the PMProEmail class for your own emails.)

= 1.5.8 =
* Fixed bugs with the Membership Billing page. (Thanks, adambware)
* The getMembershipLevelForUser function and getMembershipLevel method of the MemberOrders class will now include expiration_number and expiration_period properties on the returned level. These are needed to properly extend membership levels when checking out for the same level.
* Added pmpro_before_send_to_paypal_standard hook. This is executed at checkout before calling the sendToPayPal method on the order. The register helper plugin has been updated to update user meta fields during this hook in addition to the pmpro_after_checkout hook. (Because for PayPal Standard, when pmpro_after_checkout is called, the $_SESSION vars are unavailable to it. So other plugins relying on the pmpro_after_checkout hook may have issues with PayPal Standard.)
* Re-Added !class_exists("Stripe") check before loading Stripe library. This assumes that other plugins using the Stripe lib are loading compatible versions and/or also checking first before loading the Stripe lib. (*It's important that you test things if you are using multiple plugins loading Stripe. If the other plugins are loading old Stripe APIs first, PMPro may not work correctly.*) The alternative is to namespace the Stripe library for PMPro which would take some more effort.
* Now running email subject lines through html_entity_decode to avoid special characters for apostrophes/etc.
* pmpro_is_login_page() now also checks if is_page("login")
* The pmpro_login_redirect and pmpro_besecure functions, which handle HTTP/HTTPS logic have been updated. pmpro_besecure is now running on login_init instead of login_head to avoid a "cannot resend headers" error. pmpro_login_redirect will strip https from the URL if FORCE_SSL_LOGIN is set but FORCE_SSL_ADMIN is not set to avoid "need to login twice" bugs.
* Updated code to support auto-hiding ads with newer versions of Easy AdSense.
* Updated how the members list CSV is generated to avoid PHP notices when meta values are not found/etc. Also added a prefix to the enclose function in memberslist-csv.php (enclose => pmpro_enclose).
* Now using get_option("date_format") when outputing a date in the admin, frontend, or in an email.
* Proper trial support for Stripe. (We use the trial_period_days parameter of the Stripe plan object to push the first payment back - since the first payment is handled in its own transaction. We now also add days to this based on the # of trial subscriptions set for the level in the admin.
* Added a pmpro_require_billing javascript variable when using Stripe. If a discount code changes the membership level to free, pmpro_require_billing will be set to false and the Stripe JS checks won't fire.

= 1.5.7 =
* Ready for WordPress 3.5
* Fixed issues in the PayPal IPN Handler that were leading to errors when users would checkout using the PayPal standard gateway.

= 1.5.6.1 =
* Fixed "invalid gateway" bug when using PayPal Express option with the PayPal/PayPalExpress gateway.
* Fixed some warnings.

= 1.5.6 =
* Fixes in the new pmpro_getMemberStartdate and pmpro_getMemberDays functions.
* Fixes to SQL queries for the expiration and trial ending crons.
* Added a pmpro_required_user_fields filter similar to the pmpro_required_billing_fields filter.
* Added a function pmpro_setMessage($message, $type) that sets $pmpro_msg and $pmpro_msgt globals if they aren't set already.
* Added a function pmpro_getClassForField($field) that will return a string including "pmpro_error" or "pmpro_required" if applicable. You can filter the classes added to the fields via the pmpro_field_classes filter.
* Showing * on required fields via javascript on the checkout page.
* Updated checkout page to highlight in red fields that are related to the error message shown.
* Added headers property to the PMProEmail object. You can add headers (e.g. to add a cc or bcc) to PMPro emails using the pmpro_email_headers filter.
* Updated Stripe library to version 1.7.10. Updated PMPro to take advantage of new "interval_count" parameter in subscriptions, so you can now have subscriptions setup for "every 2 months", etc.
* Fix to pmpro_checkout_start_date_keep_startdate filter added in 1.5.5
* Added "Start Date" and "End Date" to emails sent to admins when a membership is cancelled.
* Now checks for CSS files in a paid-memberships-pro subfolder of your active theme and uses those admin.css, frontend.css, and print.css files instead if they exist. (Going to move email and page template checks to that subfolder in the future as well.)

= 1.5.5 =
* Updated pmpro_check_site_url_for_https function to cache the siteurl to limit DB queries.
* Added includes/filters.php to store hacks/filters/actions that were originally developed outside of the PMPro core and brought in later... or just things that are cleaner/easier to impement via hooks and filters.
* Added a "delay" property to the membership shortcode. E.g. [membership level="1" delay="7"]...[/membership] will show that content if a member has had level 1 for at least 7 days.
* If a member checks out for the same level again (extending their membership), the startdate added to pmpro_memberships_users will be their old startdate.
* If a member checks out for the same level again, the remaining days on their existing membership will be added to their new enddate. So e.g. if a user starts an annual membership in April 2013, then checks out again (extends) their membership in February 2014, their new enddate will be April 2015 instead of February 2015. (NOTE: if you were doing this through the custom code here - https://gist.github.com/3678054 - you should remove your custom code.)
* Fixed bug where you couldn't remove all required membership levels from a page/post. (Thanks, lisaleague)
* Updated the button CSS included in paid-memberships-pro/css/frontend.css. I added a pmpro_ prefix to these classes so they don't conflict with other .btn CSS rules. I also changed the rules a bit to show the buttons more consistently. If you relied on the old CSS rules, you may need to tweak your theme to get things looking right.

= 1.5.4 =
* Added a gateway check to preheaders/checkout.php. Mischivous users used to be able to bypass payment by passing &gateway=check or something similar to the checkout page. PMPro would then use the check gateway to checkout. Now only the active gateway option in the payments settings or gateways added via the new pmpro_valid_gateways filter (1 parameter is the array of gateways, add/edit the gateways and return the array). It is important that all PMPro users upgrade to keep mischivious users from accessing your site for free. Any site currently enabling multiple gateway options will need to add code to set the valid gateways. More info here: http://www.paidmembershipspro.com/2012/06/offering-multiple-gateway-options-at-checkout/
* Fixed bug where level restrictions would be deleted if a page were updated via quick edit.
* Added if(!class_exists("Stripe")) to the Stripe class definition. This should help with some conflicts if other plugins have their own Stripe library. (Going to udate the Stripe library in the next version and work on supporting new Stripe functionality.)
* Fixed a bug where copying a level didn't properly set recurring billing settings. (Thanks, AtheistsUnited)
* Fixed some typos. (Thanks, AtheistsUnited)
* Fixed some warnings.

= 1.5.3.1 =
* Fixed bug in expiration warning cron query. (Backported to 1.5.3)

= 1.5.3 =
* Added PayPal Standard Gateway
* Added code to support using Stripe with the minimal billing fields. Use add_filter("pmpro_stripe_lite", "__return_true"); to enable this
* Added an Email setting to send the default WordPress new user email(wp_new_user_notification) or not. By default this was being sent along with the PMPro checkout confirmation email. Now only the checkout confirmation email will be sent unless you check the new setting. You can still override this with the pmpro_wp_new_user_notification filter.
* Fixed bug: Now re-hiding the "Processing..." message if there is a Stripe javascript error at checkout.
* Updated MemberOrder method saveOrder to check for gateway and gateway_environment properties when inserting. If none are found, it will use what is set in your payment settings. This allows you to set the gateway on a MemberOrder object and save the order with that gateway instead of the default.
* Now only showing the check instructions if the gateway is "check" AND the level is not free.
* Added a check to the notification code in the settings header so it wouldn't display NULL in the notification space if WP passes that back.
* Some warning fixes.
* Fixed a bug in the PayPal Express gateway class where the pre-tax amount was being passed to PayPal instead of the tax-computed amount.
* Added Canadian Dollars as a currency option for Stripe.
* Fixed typo/bug with saving trial amounts in the memberships_users table after checkout. (Thanks, Badfun)
* Fixed bug in initial and recurring revenue calculation on members list page.
* Fixed bug when setting membership_level of current user after checkout that could cause various issues. (Thanks, drrobotnik)
* Fixed bug in Stripe webhook that resulting in cancelation emails being sent to the 1st user in the DB vs. the user who cancelled. (Thanks, Kunjan of QuarkStudios.com)
* The getLastMemberOrder() method of the MemberOrder class now returns the last order with status = 'success' by deafult. You can override this via the second parameter of the function. So getLastMemberOrder($user_id, "cancelled") to get the last cancelled order or getLastMemberOrder($user_id, false) to get the last order no matter the status.
* Added pmpro_authnet_silent_post_fields filter and pmpro_before_authnet_silent_post and pmpro_after_authnet_silent_post hooks to the Authorize.net silent post handler. All hooks are passed the $fields variable built at the top of the script that mirrors the $_REQUEST array.

= 1.5.2.1 =
* Fixed bugs with pmpro_hasMembershipLevel.
* Added ability to use the 0 level (non-member) in arrays passed to pmpro_hasMembershipLevel. e.g. pmpro_hasMembershipLevel(0,1,2) = has no membership, level 1, or level 2.
* Fixed bug with the pmpro_after_change_membership_level hook, where a level object was passed instead of the id. The object would be nice to have, but we've been passing the id in the past. I changed it back for reverse compatibility. (You can always look up the level by level_id and user_id.

= 1.5.2 =
* Added "Pay by Check" as a gateway option. Users gain immediate access. You can show instructions for who to write the check out to, where to mail it, etc.
* Added uninstall.php script. (Thanks, badfun)
* Fixed bug where the "Use SSL" option reverted to "No" for Testing, Stripe, and PayPal Express gateways whenever the payments settings page was loaded.
* Fixed bug where the IPN Handler URL was not showing up when PayPal Express was selected.
* Fixed bug where PMPro was not sending the proper trial amount to PayPal when using Website Payments Pro or PayPal Express.
* Added id and status fields to the pmpro_memberships_users table and updated all code to use these fields. This is important for allowing multiple membership levels and tracking cancelled orders. (Thanks, Zookatron!)
* Appending ?level=# to the confirmation page URL after checkout to aid in analytics tracking.
* No longer filtering pages/posts from search results if "show excerpts" is set to YES.
* Showing tax on invoices if applicable.
* Sending tax amount to PayPal Express again.
* Added code to force HTTPS if the siteurl option starts with https:
* Hiding billing information box on Membership Account page if the last invoice was by check or paypal express.
* Added pmpro_email_days_til_expiration and pmpro_email_days_til_trial_end to change how many days before expiration/etc to send an email. The default is 7.
* Fixed typo/bug in preheader/checkout.php RE the pmpro_stripe_verify_address hook. (Thanks, Oniiru!)
* Updated the_excerpt filters to prevent PMPro messages from being added to an excerpt twice in some setups.
* the_content filter removes any class="more-link" class from the content if showing an excerpt.

= 1.5.1 =
* Fixed bug in getfile.php introduced in 1.5.
* Fixed bug in the saveOrder method of the Member Order class. When "updating" vs. "inserting" the $id property of the class was being wiped out. This sometimes caused problems if the id was needed later, e.g. with PayPal Express updating orders.
* Now checking if(!defined("WP_USE_THEMES")) instead of if(function_exists("get_userdata")) to see if WP is already loaded.
* Added initial payment to the fee column of the members list.
* Added initial payment as a column in the members list CSV export.
* Added the pmpro_members_list_csv_extra_columns filter to add columns to the Members List CSV export. Sample usage here: https://gist.github.com/3111715

= 1.5 =
* Very important security fix. Please upgrade to 1.5.
* The Members List CSV export is now executed through admin-ajax.php and will only work if you are logged in as an admin (can manage options).
* Fixed service scripts to work if logged in or logged out.
* Changed the applydiscountcode service to going through the site_url() instead of admin-ajax.php to avoid HTTP/HTTPS issues.

= 1.4.9 =
* Important: Fixed handling of services sent through admin-ajax.php. Your silent post/ipnhandler URLs, etc, may have been updated.
* Added stripslashes() to membership description output on the checkout page.
* The pmpro_getLevel() function may return the wrong level on the levels, checkout, or account page where another $pmpro_levels array was setup. (The array pmpro_getLevel uses used the level id as the array keys. The older $pmpro_levels used 0-n.) To fix this, I added a pmpro_getAllLevels($include_hidden = false) function and now use that function on the levels, checkout, and account pages. The function queries the database for all levels and then puts them into an array where the level ids are the keys.
* Fix for !!billing_country!! in emails. (Somehow a previous fix for this got overwritten. My bad.)
* Settings $pmpro_level->code_id to $discount_code_id if a valid discount code is applied to a level at checkout. This is
useful for determining if/what discount code was applied to the level when processing it in hooks.
* Added pmpro_getDomainFromURL() and using that to set PMPRO_URL.
* New hooks when orders are added/updated: pmpro_update_order (before update), pmpro_updated_order (after update), pmpro_add_order (before add), pmpro_added_order (after add). (Thanks, zookatron!)

= 1.4.8 =
* Fixed !!siteemail!! values for email templates.
* Adjusted display of "processing" message next to checkout button when clicked.
* Added billing_country to orders table in DB and the memberorder class. Handling countries better through the code.
* Removing closing ?> at the bottom of various files while working through. This can avoid errors on some setups.
* Using wp_enqueue_style to load plugin stylesheets now.
* Added the pmpro_getCheckoutButton($level_id, $button_text, $classes) function and [pmpro_button level="1"] shortcode to add buttons with links to more easily level checkout pages into your pages and themes. Copied over btn and btn-primary styles from Member Lite theme.
* Updated include/require statements to work if the wp-content folder has been renamed or moved.
* Added code to load scripts in the services folder via admin-ajax.php. (Helps when the plugins folder is not where PMPro expects it to be.)
* The discount code AJAX call is using the new service URL (/wp-admin/admin-ajax.php?action=applydiscountcode).
* Added IPN/Silent Post/Webhook instructions to payment settings page.

= 1.4.7 =
* Fixed some notices in the PayPal gateway code.
* No longer calling Stripe JS at checkout if the level is free.
* Fixed some HTTPS handling for ISS hosting. (IIS sets $_SERVER['HTTPS'] to "off" or "on" instead of TRUE or FALSE.)
* Added #pmpro_processing_message to checkout page which is shown when the submit button is clicked. You can override the message with the pmpro_processing_message filter. You can tweak the CSS to show this differently as well.

= 1.4.6 =
* No longer trying to setup a subscription with Stripe for levels with only an Initial Payment amount.
* Updated recaptchalib.php, which fixes issues with using recaptcha.
* Now setting the first_name and last_name meta fields at checkout to match the business first and last name. (Previous scripts to add additional first/last names to the checkout field should override these.)
* Updated the save profile code to only null out the expiration date for a membership if a blank expiration is explicitly passed through the form. If you had other plugins allowing users to edit their profile, etc, it might not have been passing the expiration date and thus updating users expiration dates. Admins and users would have gotten emails.
* Some updates to applydiscountcodes.php service to support plugging into how discount codes function. Added the pmpro_discount_code_level filter to applydiscountcodes.php.

= 1.4.5.1 =
* Removed debug calls to krumo() which would cause fatal errors in certain situations. Please upgrade. (Note that PMPro versions that go three dots deep are usually the most important ones :)

= 1.4.5 =
* Now setting a var "code_level" in javascript in applydiscountcode.php so it can be used to manipulate prices, etc after applying a discount code.
* Added the pmpro_cancel_previous_subscriptions filter, which is set to false will skip cancelling the old membership level/subscription at checkout. This is dangerous, but is used by the pmpro-addon-packages plugin to have an addon charge without affecting the old subscription. This works because the user is checking out for the same membership level. (So they don't really have > 1 membership level.)
* Trimming strings sent to the Authorize.net API in the subscribe and update calls.

= 1.4.4 =
* Using get_admin_url instead of home_url in various places so the links will work on sites installed in a subdirectory. (Notifications, admin bar, pagination in admin screens, etc.)
* Wrapping some XML fields in Authorize.net API calls in <![CDATA[ ]]> to avoid issues when non-text characters (e.g. &) are included in the level name, etc.

= 1.4.3 =
* Fixed a bunch of notices and warnings on discount codes page in admin.
* Added hooks for changing the discount code page: pmpro_save_discount_code_level, pmpro_save_discount_code, pmpro_discount_code_after_settings, pmpro_discount_code_after_level_settings. Look them up in discountcodes.php to see how they work.
* Updated pmpro_send_html(), which filters emails, to use wpautop instead of nl2br. This will fix any extra double spacing you may have noticed in your emails.
* Added a stripslashes around the membership level confirmation text on the confirmation page. Extra slashes were breaking links, etc.
* Added membership level to subj
