(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=233)})({161:function(a,b){'use strict';Object.defineProperty(b,'__esModule',{value:!0});b.getMonsterlink=function(a){return OMAPI.monsterlink+a+'/'}},233:function(a,b,c){'use strict';var d=c(161);window.OMAPI_Editor=window.OMAPI_Editor||{},function(a,b,c,f){a.OMAPI=a.OMAPI||{},OMAPI.monsterlink=f.monsterlink,f.getActiveEditorId=function(){var b=a.wpActiveEditor,c=a.tinymce;return wp.media.editor.activeEditor&&(b=wp.media.editor.activeEditor),!b&&c&&c.activeEditor&&(b=c.activeEditor.id),b},f.getActiveEditor=function(){var b=f.getActiveEditorId();return b&&a.tinymce?a.tinymce.get(b):null},f.mceLinkifyText=function(){var a=f.$select.val();a&&f.getActiveEditor().execCommand('mceInsertLink',!1,{href:(0,d.getMonsterlink)(a),target:'_blank',rel:'noopener noreferrer'})},f.modalOpenLink=function(){f.$toToggle.addClass('optin-monster-modal-monsterlink').removeClass('optin-monster-modal-inline'),f.$body.addClass('modal-open om-modal-open-monsterlink'),f.$modalWrap.show(),f.updateLinkSelectOptions(f.$select);var a=c('.wp-link-input').parent().find('.dashicons-admin-generic').parent();a.click(),c(b).trigger('om-modal-open-monsterlink')},f.modalOpenInline=function(){f.$toToggle.addClass('optin-monster-modal-inline').removeClass('optin-monster-modal-monsterlink').show(),f.$body.addClass('modal-open om-modal-open-inline'),f.updateInlineSelectOptions(),c(b).trigger('om-modal-open-inline')},f.modalClose=function(){['$select','$linkSelect','$inlineSelect'].forEach(function(a){f[a]&&f[a].length&&f[a].val('')}),f.$toToggle.hide();var a=f.$body.hasClass('om-modal-open-monsterlink')?'monsterlink':'inline';f.$body.removeClass('modal-open om-modal-open-monsterlink om-modal-open-inline'),c(b).trigger('om-modal-close-'+a)},f.insertShortcode=function(){var a=f.$inlineSelect.val();a&&wp.media.editor.insert('[optin-monster id="'+a+'"]')},f.updateLinkSelectOptions=function(a){var b=c('#wp-link-wrap #link-selector'),e=b.find('#search-panel'),f=e.offset().top+e.outerHeight(),g=f-b.offset().top+12;c('.has-text-field #wp-link .query-results').css({top:g});var h=c('.wp-link-input input.ui-autocomplete-input').val();h&&a.find('option').each(function(){var b=c(this).val();b&&h===(0,d.getMonsterlink)(b)&&a.val(b)})},f.updateInlineSelectOptions=function(){var a=f.getActiveEditorId();if(a){var d=f.getActiveEditor(),e=d&&!d.isHidden()?d.getContent():b.getElementById(a).value;f.$inlineSelect.find('option').each(function(){var a=c(this),b=0<=e.indexOf('optin-monster id="'+a.val()+'"');a.attr('disabled',b)})}},f.initLinkButton=function(){c('.wp-link-input').each(function(){var a=c(this).parent();if(!a.find('.optin-monster-insert-monsterlink').length){var b=c('<div class="mce-widget mce-btn mce-last" tabindex="-1" role="button" aria-label="OptinMonster" style="margin-left:-3px;"></div>'),d=c('<button role="presentation" type="button" tabindex="-1" class="optin-monster-insert-monsterlink"></button>');d.append(c('.wp-media-buttons-icon.optin-monster-menu-icon').first().clone()),b.append(d),a.find('.mce-last').removeClass('mce-last'),a.append(b)}})},f.initAdvancedSettings=function(){var b=c('\n\t\t\t<p class="howto" id="om-link-campaign-label">Or link to a popup campaign</p>\n\t\t\t<div style="margin-bottom: -8px;">\n\t\t\t\t<label><span>Select</span>\n\t\t\t\t\t<select name="om-link-class" id="om-link-campaign" aria-describedby="om-link-campaign-label">\n\t\t\t\t\t</select>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t');if(b.find('select').html(f.$select.find('option').clone()),c('#link-options').append(b),f.$linkSelect=c('#om-link-campaign'),'undefined'!=typeof a.wpLink){var e=wpLink.getAttrs;wpLink.getAttrs=function(){var a=e(),b=(0,d.getMonsterlink)(f.$linkSelect.val());return a.href===b&&(a.target='_blank',a.rel='noopener noreferrer'),a}}},f.initEditorMods=function(a){!a||a.hasInitiatedOm||(a.hasInitiatedOm=!0,a.on('ExecCommand',function(a){'WP_Link'===a.command&&f.initLinkButton()}),!f.$linkSelect&&f.initAdvancedSettings())},f.setupListeners=function(){c(b).on('click','.optin-monster-insert-campaign-button',function(a){a.preventDefault(),f.modalOpenInline()}).on('click','.optin-monster-insert-monsterlink',function(a){a.preventDefault(),f.modalOpenLink()}).on('click','#optin-monster-modal-backdrop, #optin-monster-modal-close, #optin-monster-modal-cancel a',function(a){a.preventDefault(),f.modalClose()}).on('click','#optin-monster-modal-submit-inline',function(a){a.preventDefault(),f.insertShortcode(),f.modalClose()}).on('click','#optin-monster-modal-submit',function(a){a.preventDefault(),f.mceLinkifyText(),f.modalClose()}).on('change','#om-link-campaign',function(){var a=f.$linkSelect.val();a&&(c('#wp-link-url').val((0,d.getMonsterlink)(a)),c('#wp-link-target').prop('checked',!0))}).on('wplink-open',function(){f.updateLinkSelectOptions(f.$linkSelect)}).on('wplink-close',function(){f.modalClose()}).on('om-modal-close-monsterlink',function(){if(wpLink){var a=f.getActiveEditor();a&&!a.isHidden()&&wpLink.close()}})},f.init=function(){f.$body=c(b.body),f.$modalWrap=c('#optin-monster-modal-wrap'),f.$toToggle=c('#optin-monster-modal-backdrop, #optin-monster-modal-wrap'),f.$select=c('#optin-monster-modal-select-campaign'),f.$inlineSelect=c('#optin-monster-modal-select-inline-campaign'),f.$linkSelect=null,f.setupListeners(),f.initEditorMods(f.getActiveEditor()),'undefined'!=typeof tinymce&&tinymce.on('SetupEditor',function(a){var b=a.editor;f.initEditorMods(b)})},c(f.init)}(window,document,jQuery,window.OMAPI_Editor)}});